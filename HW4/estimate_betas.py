from scipy.optimize import curve_fit
import math
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression

def func(x, b1, b2, b3):
    return 1/(b1*x+b2)+b3

def estimate_loss(x, y, depth):
    popt, pcov = curve_fit(func, x, y)
    print("Resnet-{}: beta0 {:.3f}, beta1 {:.3f}, beta2 {:.9f}".format(depth, popt[0], popt[1], popt[2]))
    return popt

x = [math.ceil(i*50000/60) for i in range(1, 351)]
print()
v100_betas = []
p100_betas = []
k80_betas = []

# V100
y = [1.586085136642456, 1.1537476987075805, 0.9657096950531006, 0.8420660660171508, 0.7519122269058227, 0.6828833712005615, 0.6229433973121643, 0.5729146686172485, 0.5238843497657776, 0.4858354977035522, 0.4574289582824707, 0.4156423399734497, 0.3956755006980896, 0.3712665360355377, 0.35247277290344237, 0.32878580088615417, 0.32369672518730164, 0.3229650072479248, 0.3071913880157471, 0.29846360120773313, 0.30716355676651, 0.2932265339756012, 0.2976266240310669, 0.2883951099395752, 0.28913800208091733, 0.2910728186607361, 0.2783065534687042, 0.29732998843193054, 0.28496634941101073, 0.2712004702281952, 0.28413330785751345, 0.2833720669555664, 0.2851222683906555, 0.27617014323234557, 0.2740217589092255, 0.2734926297187805, 0.28187952527999877, 0.2831760463142395, 0.2712347883796692, 0.28059707936286926, 0.2821406025123596, 0.2616313596916199, 0.27915946308135986, 0.276271979598999, 0.2684709256267548, 0.27514683519363403, 0.2694704904937744, 0.27206103071212767, 0.28034937912940977, 0.2690489590024948, 0.2709340726852417, 0.26069018051147463, 0.27377728677749635, 0.2725248243331909, 0.26186593722343443, 0.26646433465003966, 0.27337995727062225, 0.2646025020313263, 0.26560026438713075, 0.26796121544837953, 0.2674255875492096, 0.26236875557899475, 0.26311749135494233, 0.267251179561615, 0.27033175926208497, 0.26560207314491274, 0.2586213030147552, 0.2604357519340515, 0.26558328894615174, 0.2655739928817749, 0.2560515915966034, 0.2631094895267487, 0.25835287728786466, 0.2630716144657135, 0.26884201555252074, 0.26085065239906313, 0.254089347486496, 0.2504958603000641, 0.2613293183231354, 0.27603323804855345, 0.2556901141452789, 0.2150814605808258, 0.2001458117055893, 0.1962847864151001, 0.1937064013147354, 0.19096382908821105, 0.18843706580638886, 0.18551440577983855, 0.18224927003860475, 0.1786578590774536, 0.1746990157318115, 0.1698926511478424, 0.16467611440181731, 0.15885895983219148, 0.15235721405982972, 0.14552241952419281, 0.13891490273952484, 0.13381834913730623, 0.12986209985256195, 0.12569526230812073, 0.1229925589108467, 0.11986766306877136, 0.11633316010713578, 0.11366237895011902, 0.11066732683897018, 0.10865156525850296, 0.1057845035481453, 0.10298433071136474, 0.10032499253988265, 0.0973968772315979, 0.09682540284395218, 0.09907032586812974, 0.09345347603559494, 0.09176775300264359, 0.09039787326812744, 0.08899179289340974, 0.08750318911075593, 0.08566195502758026, 0.08407632851362229, 0.0830851476097107, 0.08901696336507797, 0.08232186850309373, 0.08147991592168807, 0.08118004521131515, 0.08098261770963669, 0.08078886093378067, 0.08059312559843064, 0.08037083770513534, 0.08018018280506134, 0.07994566745996476, 0.0797255743265152, 0.07939761919975281, 0.0791135622048378, 0.07873972942829133, 0.07839829908847809, 0.07799765964031219, 0.07752581753253937, 0.07706113625764847, 0.07652871953725815, 0.07600437219142914, 0.07547302876710892, 0.07497269074201583, 0.07442301455497742, 0.07388684517383576, 0.07333460299253464, 0.07272173296451569, 0.0720583307981491, 0.07135602519512177, 0.07063046969413757, 0.06990292746305465, 0.06922379750728608, 0.06855987013101578, 0.06788623392343521, 0.06718769007921219, 0.0664860427570343, 0.06573777472257614, 0.06497057917356491, 0.06418682755947112, 0.06342781239271164, 0.062759406914711, 0.062099643023014066, 0.06174566039800644, 0.061662563256025316, 0.061583754682540896, 0.061495192301273344, 0.061398971424102784, 0.06130360797286034, 0.06121017145752907, 0.061117815861701966, 0.06100028090953827, 0.060907494730949405, 0.060833617933988574, 0.06074218307971954, 0.06067857480049133, 0.060591599951982496, 0.06051672126531601, 0.06044278792142868, 0.06036455879688263, 0.06027486101388931, 0.060190416246652605, 0.06010279519081116, 0.06003249695777893, 0.05998828355550766, 0.05992951247692108, 0.05987600552082062, 0.059832269130945206, 0.059780953466892245, 0.059734640350341796, 0.05968643303632736, 0.05963846470594406, 0.059585988199710845, 0.05954600741505623, 0.059489265062808994, 0.05943621695160866, 0.05938986297249794, 0.05934512292981148, 0.05930074040293694, 0.05926307520866394, 0.05921535175442696, 0.05917237577199936, 0.05913757609128952, 0.059092529078722, 0.05904419231891632, 0.05901356500983238, 0.05894853835940361, 0.05891293088674545, 0.058853382352590564, 0.05880227121710777, 0.058747280521392824, 0.058693329807519914, 0.05864456280350685, 0.05860211022377014, 0.05854650569796562, 0.05851393494486809, 0.058471023753881454, 0.058424839888811114, 0.05837968468427658, 0.05833721367955208, 0.0582805636203289, 0.058247502168416974, 0.05818484876990318, 0.058130837931633, 0.05810169254899025, 0.05804474879145622, 0.057993908816576005, 0.05797170579910278, 0.057916035932302476, 0.05788003747940063, 0.057830016640424725, 0.05778825343489647, 0.05774449801325798, 0.05769265315413475, 0.057637118862867355, 0.05758453882575035, 0.05754073312044144, 0.0574929541528225, 0.05745485672473907, 0.05739797125220299, 0.05736578741669655, 0.05732183066725731, 0.0572860273873806, 0.05723473062992096, 0.05720563616037369, 0.05714519511699676, 0.05710722890734673, 0.057082648767232895, 0.057041943653821946, 0.057017165776491165, 0.056968066877126695, 0.05693481909275055, 0.05690815880537033, 0.05687102455258369, 0.056821820806264876, 0.056785734242200854, 0.05674118941545486, 0.056713982017040254, 0.05666425619125366, 0.05661321177124977, 0.056556158179044726, 0.05651275078773498, 0.05645714065670967, 0.05640652901887894, 0.05634583386540413, 0.05629842707157135, 0.05624418972611427, 0.05620822335600853, 0.056154128382205966, 0.056107476267814635, 0.05608558466076851, 0.05603133379459381, 0.0559907794380188, 0.05597857705831528, 0.0559226764690876, 0.055892326806783674, 0.05585296504735947, 0.05581759219646454, 0.05578029242873192, 0.055742974001169204, 0.05570686894774437, 0.05566858003020286, 0.05563211942672729, 0.05558860854148865, 0.0555502995967865, 0.055497248762845994, 0.055470172089338306, 0.05542137735247612, 0.05537417326807976, 0.05533221372127533, 0.055298821309804916, 0.05524524391651153, 0.05520478878736496, 0.05515112730503082, 0.05510763177275658, 0.05506000445842743, 0.05501262013435364, 0.054968121756315234, 0.05491765718102455, 0.05487280944705009, 0.054827723658084866, 0.05478114828944206, 0.054742036257982254, 0.05469424144268036, 0.054664813791513445, 0.05462790980100632, 0.054583017681837084, 0.054544322681427004, 0.05450096282958984, 0.05446572780013084, 0.05441219634532928, 0.05436516236305237, 0.05432074916601181, 0.05427810790300369, 0.05422315779209137, 0.05420069709181786, 0.05415066889166832, 0.05411378612875938, 0.05407915291666984, 0.05401968169569969, 0.053990260779857635, 0.05394813474059105, 0.053900162428617476, 0.05388204283118248, 0.053829503029584884, 0.05379760218977928, 0.05375771781802177, 0.05371486349701882, 0.05368896032094955, 0.05364914945840835, 0.05361131684780121, 0.05357973135948181, 0.053534716181755065, 0.053504927361011506, 0.05346821776866913, 0.053429423534870145, 0.053381926550865176, 0.05334424674987793, 0.05330548236370087, 0.05325935093402862, 0.053221516072750094, 0.05318313712120056, 0.05313947547316551, 0.053109028097391126, 0.05307075193881988, 0.053034288773536685, 0.052985472855567935, 0.052938051850795746, 0.05289719254612923, 0.052853378483057024, 0.052806125223636625, 0.05275870916247368]
v100_betas.append(estimate_loss(x, y, 20))

y = [1.6507089812469482, 1.2072754361724853, 1.0114882995224, 0.8799135199928284, 0.7877730678939819, 0.7127238679695129, 0.6508727016639709, 0.5997206916809082, 0.5478719466018677, 0.5027586655807496, 0.4710592722320557, 0.44377578243255617, 0.41986814798355104, 0.3961530864715576, 0.37603307498931887, 0.37292206758499147, 0.3580599507045746, 0.3494327346420288, 0.34155261102676393, 0.34088780137062075, 0.33445675842285155, 0.3371164961051941, 0.3236027585220337, 0.3264156606960297, 0.3280779333400726, 0.32260103202819823, 0.31922432092666625, 0.30914710954666136, 0.31555753984451296, 0.315593815164566, 0.3161142700576782, 0.31539041271209717, 0.3115560614967346, 0.31017352907180784, 0.30519322427749634, 0.3083903877735138, 0.3117199645233154, 0.3060551416873932, 0.3110658990955353, 0.29885362927436826, 0.30410207200050354, 0.3010516427898407, 0.31175604191780093, 0.2975343885421753, 0.29684067853927615, 0.3012170819568634, 0.30648736300468443, 0.289954672498703, 0.30282484813690186, 0.29874404034614566, 0.3035208818817139, 0.29836116908073423, 0.29616020042419433, 0.2890161595249176, 0.2975892363739014, 0.29185007435798643, 0.2923955032634735, 0.299187593832016, 0.2865656884384155, 0.2933083746433258, 0.29811626450538636, 0.2862479148483276, 0.2897068994140625, 0.2865919973373413, 0.2915179050731659, 0.28630617582321166, 0.2933030774497986, 0.2869841187763214, 0.27943236658096315, 0.2880099823474884, 0.286514181728363, 0.2830280128192902, 0.2867959198188782, 0.2820381238985062, 0.29149921760559083, 0.279497293138504, 0.28395900722503664, 0.2762948341178894, 0.277702032957077, 0.28036486181259157, 0.27980622251510623, 0.23496746116161346, 0.21770170437335967, 0.21373852219581604, 0.2101999575805664, 0.20723747772216797, 0.20412825818538666, 0.20027010118961333, 0.19617007603168488, 0.1915204252576828, 0.18641005782604217, 0.18038796295166015, 0.17395538129806518, 0.16705143197536468, 0.15961226216316224, 0.1518420492887497, 0.14539450250148772, 0.14127329535007477, 0.13642412693977357, 0.13246246424198152, 0.12835294890403748, 0.12473636958122253, 0.1233954821562767, 0.12033977199316025, 0.11823805245399475, 0.11529888057231903, 0.11269170067071915, 0.11002292024850846, 0.10801503648281098, 0.11017080771684647, 0.10510202715873718, 0.10297901061058044, 0.1013037916970253, 0.09933477555274964, 0.09741280618667603, 0.09859454621315003, 0.09765743681192399, 0.09473212336540222, 0.09339799922943115, 0.09183828857660294, 0.09022808668136596, 0.08924755156993866, 0.08906361210823059, 0.08882044774055481, 0.088615430560112, 0.08824789414167404, 0.08792924598455429, 0.08755840777873992, 0.08708295058250427, 0.08658982804775238, 0.08599678506135941, 0.08533075878620147, 0.08457485054254532, 0.08378159710407257, 0.08299125271081924, 0.08215523931503296, 0.08123386718273162, 0.08024229697942734, 0.07917705828428269, 0.07811570699930191, 0.07708049695968627, 0.07598639158248902, 0.0748304165148735, 0.07360624191522598, 0.07240872444391251, 0.07122711871623993, 0.07007856417894363, 0.06892041379213333, 0.06787216914653778, 0.06686923924446106, 0.06596981772184372, 0.06517890897750854, 0.06444931082725525, 0.06375326618909836, 0.06307840626239776, 0.06240287603735924, 0.06167471957206726, 0.06086417590498924, 0.059995523419380185, 0.05907431297779083, 0.05810767379045487, 0.057574878519773484, 0.05755658899903297, 0.0574229161131382, 0.05735799319386482, 0.05729185634255409, 0.05721302756309509, 0.057144996408224104, 0.05705702625632286, 0.056995683615207675, 0.056918022223711014, 0.05683222951889038, 0.05677266906619072, 0.05667891006350517, 0.05660699339389801, 0.05651731079220772, 0.056429249091148374, 0.05633895335793495, 0.05625649386405945, 0.05616606708407402, 0.05607323041319847, 0.05601235682606697, 0.0559617546081543, 0.05590499011278152, 0.05585983462333679, 0.05579699223160744, 0.055755716713666914, 0.0556987590944767, 0.05565320610404015, 0.05558536790847778, 0.0555435816192627, 0.055485589911937715, 0.055434439650774, 0.05538277088284493, 0.055317488832473755, 0.05526563564181328, 0.055207053006887434, 0.05515329703092575, 0.05509607816696167, 0.05503390186667442, 0.054981544489860534, 0.054932573215961455, 0.05486500947833061, 0.05481659197211266, 0.05477332234740257, 0.05471557520866394, 0.05468279580593109, 0.054644265793561936, 0.054598041676282884, 0.054551586277484895, 0.05450452467441559, 0.05448904197573662, 0.054430222284793855, 0.0543871751499176, 0.054345893646478655, 0.054290803554058076, 0.05424577354669571, 0.05419917609095574, 0.05414694214940071, 0.05409573087453842, 0.054061064997911454, 0.054015241173505785, 0.05396284781336785, 0.053916121178865434, 0.05387636988162994, 0.05382001452207565, 0.05376892109870911, 0.05372108429670334, 0.05366974138379097, 0.05362328081846237, 0.05356940891027451, 0.053526108210086826, 0.05347934514045715, 0.05342087726950646, 0.05337610470890999, 0.05331924122929573, 0.053258003650903704, 0.05319637208342552, 0.05312850023508072, 0.05306362172007561, 0.05300356103897095, 0.052932368013858797, 0.052881438603401186, 0.05281534723997116, 0.052748651160001755, 0.05269500823736191, 0.052630787889957426, 0.05256761945486069, 0.05251754203796387, 0.052459936715364454, 0.052390981318950654, 0.05233425614953041, 0.05226435971975327, 0.052246811726093294, 0.05216711678981781, 0.05214712327837944, 0.05211903254032135, 0.052084926973581316, 0.05205480170011521, 0.05202306025624275, 0.052009054909944535, 0.0519465562415123, 0.05191571219921112, 0.05187480321884155, 0.05185645637154579, 0.05179932147145271, 0.05176310012578964, 0.05171532248854637, 0.05166439225673675, 0.05162384109854698, 0.051571455421447754, 0.05152087450504303, 0.05146180359005928, 0.05140235303521156, 0.05135006416797638, 0.05129081665873528, 0.0512318536734581, 0.05117788414120674, 0.0511264000916481, 0.05107172491669655, 0.05101767664670944, 0.05096468228816986, 0.0509108244729042, 0.050859159078598025, 0.05082006805062294, 0.05078605819106102, 0.05075190148711205, 0.05072158348441124, 0.050687759577035904, 0.05067697937488556, 0.05061927632689476, 0.050588776556253434, 0.050570800911188124, 0.05052685468673706, 0.050494175473451614, 0.05046279105067253, 0.05042682631969452, 0.050379948296546934, 0.050338611736297605, 0.05029294286847114, 0.05024042907834053, 0.05018939065694809, 0.05013456626176834, 0.05008603531122208, 0.05003019532442093, 0.04999923041462898, 0.04994389419436455, 0.04989657624840736, 0.04986610500812531, 0.04981996579289436, 0.04978890611648559, 0.04973254179000854, 0.04969872340083122, 0.04966101627469063, 0.04961249736070633, 0.049567219827175144, 0.04951444791078567, 0.04947340740323067, 0.04941171261191368, 0.049372438406944275, 0.04932439732670784, 0.04927379361867905, 0.04922146794557571, 0.04917270114779472, 0.0491244726383686, 0.04907874166965485, 0.04903674996852875, 0.04899650922417641, 0.04895640462398529, 0.048904617065191267, 0.04885823369860649, 0.04880668862819672, 0.048754972484111786, 0.048697096847295764, 0.048644701564311985, 0.04858605959415436, 0.048537832506895064, 0.048480063662528994, 0.048435632973909376, 0.048386016187667844, 0.0483349115049839, 0.04827987518310547, 0.04821829288959503, 0.04816152603387833, 0.04809491068601608, 0.048038330241441725, 0.04797658744812012, 0.047925359992980955, 0.04789864935159683, 0.047844258035421375]
v100_betas.append(estimate_loss(x, y, 26))

y = [1.7341044930648803, 1.2472253657913208, 1.0288964980125428, 0.8923395790100098, 0.7940432382583618, 0.7151137845611573, 0.6548421396636963, 0.6011338203811646, 0.5586534547424317, 0.5135442576599121, 0.4770244407081604, 0.4456117501449585, 0.4300484889602661, 0.41274511773109435, 0.3930735162830353, 0.3771554566478729, 0.3847465905666351, 0.3644677957820892, 0.3641657959365845, 0.36158303649902346, 0.3549932562828064, 0.3480755149364471, 0.34065593166351316, 0.3470305511856079, 0.3488685659790039, 0.3379726739692688, 0.33923187344551087, 0.33672997294425966, 0.33973929090499877, 0.33040800293922423, 0.3356395498085022, 0.3313325653076172, 0.3288611344718933, 0.33254386545181275, 0.3304166895198822, 0.3246329896736145, 0.3228700729942322, 0.3311756791782379, 0.3245572805595398, 0.3242451499557495, 0.32179481870651244, 0.3164581918048859, 0.32320813107490537, 0.32203002559661864, 0.319321228723526, 0.31380678308486937, 0.3226470204257965, 0.3145305377006531, 0.3165720499134064, 0.31606383437156677, 0.3156932372093201, 0.31158102591514586, 0.3109564297389984, 0.30822190850257875, 0.3079894875717163, 0.3112267429637909, 0.31389055994987486, 0.3030911660575867, 0.31092963345527647, 0.30967841238975524, 0.30511214259147645, 0.3024611902809143, 0.3022391223430634, 0.3065125099849701, 0.30038627129554746, 0.3000692588329315, 0.31067159658908844, 0.2868175512123108, 0.30732686964035033, 0.29612987701416016, 0.2998639155101776, 0.2993606413269043, 0.29735605557441713, 0.2954693004798889, 0.2894452500629425, 0.29992197184562686, 0.2939626934146881, 0.294272723236084, 0.2909578854179382, 0.2949549462509155, 0.2935886744403839, 0.24682402444839477, 0.22994458643913268, 0.22589460749149323, 0.22200775592327118, 0.21834393685817718, 0.2145264421272278, 0.21004157050132752, 0.2050169760608673, 0.19920607205867769, 0.19277120262622832, 0.1856428783416748, 0.17763168766021728, 0.16902154210090636, 0.1599064989376068, 0.1501544091272354, 0.14089122049331665, 0.13832120471477508, 0.13317213886260987, 0.1293442802429199, 0.12605878592014313, 0.12243566233634949, 0.11846926669597625, 0.11396300637245178, 0.11049322650909424, 0.11323641303777694, 0.1070969614481926, 0.10455122928619384, 0.10311610737800599, 0.10158625126838684, 0.09913070251703263, 0.09756422372102737, 0.09808799737215042, 0.09627934230566025, 0.09372210944890975, 0.09220615664482117, 0.09119403136253357, 0.08969874918699265, 0.08784201479911805, 0.08684930551767349, 0.0875822381567955, 0.08519343712806701, 0.08445763175249099, 0.08419169623613358, 0.08393712532997132, 0.08363051153182983, 0.08337908458709717, 0.08312056080102921, 0.08280476655960083, 0.0823996043252945, 0.08201942175388337, 0.08152728025197983, 0.0810256412100792, 0.08046294676542282, 0.07980311604976655, 0.07914040156841277, 0.07840781782150269, 0.07760039693832398, 0.0767311600470543, 0.0757937812423706, 0.07480732332468033, 0.07380134778738022, 0.07279140177488327, 0.07172217650175094, 0.07054214234113693, 0.0694213059425354, 0.06838439049243927, 0.06731446446180343, 0.06622752662181854, 0.06514615989685059, 0.06408507724761962, 0.06308699913024902, 0.06207812300562859, 0.06105029859185219, 0.05998219057798385, 0.05890884506583214, 0.057831662269830705, 0.05705885637879372, 0.05652762571692467, 0.05598832600474358, 0.0554006436419487, 0.05504247185587883, 0.054960882260799405, 0.054882661349773404, 0.054784268808364865, 0.054683363020420074, 0.054573775528669356, 0.05445870278954506, 0.05433697359919548, 0.05420880043506622, 0.05408253099441528, 0.053955230211019514, 0.05385148139715195, 0.05373100827455521, 0.05362219302892685, 0.05351133555650711, 0.05338405132651329, 0.053267034057378766, 0.053137024303674694, 0.05302340987563133, 0.05290008071780205, 0.05281040139913559, 0.052749823410511015, 0.0526850871181488, 0.052619584070444106, 0.05255283321738243, 0.05248451320171356, 0.052427097444534304, 0.052360011510849, 0.05230273214578628, 0.052241004003286365, 0.0521922514128685, 0.052135028357505796, 0.052081904610395434, 0.05203878365516663, 0.05197960912823677, 0.05195259045958519, 0.05190440101861954, 0.05185855842471123, 0.05181569174408913, 0.051765321669578555, 0.05170806201696396, 0.05165259706735611, 0.05158362118959427, 0.05151166352152824, 0.05143697483897209, 0.05135766507744789, 0.05127774994134903, 0.05120385290265083, 0.05112048619508743, 0.05106122553229332, 0.05097932636380196, 0.05092418703436852, 0.050880535014867785, 0.050824409943819045, 0.05078653274893761, 0.05074032166838646, 0.05068304629921913, 0.05065112350821495, 0.050590122801065444, 0.050550854667425156, 0.05049865697979927, 0.0504416374027729, 0.05040219740271568, 0.05034114209294319, 0.05030045316338539, 0.05025239215373993, 0.05021588099002838, 0.05015613380789757, 0.05010922081112862, 0.05005456765651703, 0.049991083226203915, 0.04992939958930016, 0.04985866389393807, 0.049798640300035474, 0.04972227422118187, 0.04965261261940002, 0.04958361443996429, 0.049513255094289776, 0.049450544167757036, 0.049380888065099715, 0.049316412533521654, 0.04925023134708405, 0.04918860724329949, 0.04912278403520584, 0.04904687909007072, 0.04898629824757576, 0.04891496393918991, 0.04885677461624145, 0.04879924708127976, 0.04873400404214859, 0.0486710192322731, 0.048603147690296174, 0.04853405118346214, 0.04846975054264069, 0.04839173727631569, 0.04833180960774422, 0.0482665817630291, 0.04821397552371025, 0.04816994794845581, 0.048106330295801164, 0.048053299556970595, 0.04799244922041893, 0.047933264852762225, 0.047867372320890424, 0.0477956153512001, 0.04773640681624412, 0.04767394983768463, 0.04760864467859268, 0.04755227098941803, 0.04749648597836494, 0.04744179249763489, 0.04741522624373436, 0.04735827258825302, 0.04732233434557915, 0.04728720168232918, 0.04724304923415184, 0.047195351784229275, 0.04716538803339004, 0.047112600021362305, 0.0470761310839653, 0.04701707929491997, 0.04697801983714104, 0.046921270722150805, 0.04687940434217453, 0.04682634094238281, 0.0467746609890461, 0.046730109218358996, 0.04667881353974342, 0.04661583866357803, 0.046565398482084276, 0.046501249163150786, 0.04643998182415962, 0.04637390560388565, 0.046305116667747497, 0.0462437842965126, 0.046175765433311464, 0.04610958187818527, 0.046054299261569974, 0.04598994089603424, 0.04592692186951637, 0.045864660396575926, 0.04579711629033089, 0.045733340357542035, 0.04566779268503189, 0.04560467883467674, 0.04554215052604675, 0.04548648315668106, 0.045422637733221055, 0.045363912324905394, 0.04530232041120529, 0.04525650899529457, 0.04520891179203987, 0.04515876002907753, 0.04510784755706787, 0.0450529898917675, 0.044997289073467256, 0.04494076403021813, 0.04487985663533211, 0.04481834334969521, 0.04476964901685715, 0.04472247249126434, 0.04467066118121147, 0.04462618939399719, 0.04457108578681946, 0.04451771992564201, 0.04445853510499, 0.04440236680030823, 0.04434818178057671, 0.04429590893149376, 0.0442405256319046, 0.04420275500416756, 0.04417553239107132, 0.04412930100917816, 0.04409038451075554, 0.04405656673550606, 0.04401406228423119, 0.0439795144033432, 0.04392826037406922, 0.04388058898091316, 0.04382224278450012, 0.043773324377536775, 0.043711815017461776, 0.04365790814757347, 0.04360153880476952, 0.043542682777643206, 0.04348440340876579, 0.04342328002929687, 0.043361621183156965, 0.04330536930203438]
v100_betas.append(estimate_loss(x, y, 32))

y = [1.8629581966781616, 1.36806435962677, 1.1270397758102417, 0.986303818321228, 0.8708815958404541, 0.7950032312202454, 0.722181480884552, 0.6723701349258423, 0.620775209236145, 0.5850550330924987, 0.5512793144607544, 0.5097075018119812, 0.490091293964386, 0.47650253728866576, 0.45846825059890745, 0.44410182552337646, 0.4349534029197693, 0.4244677980899811, 0.426829849319458, 0.41019881638526917, 0.41055945851325987, 0.4069220201683044, 0.40564959465026856, 0.3941000575447082, 0.4000804006767273, 0.38769899388313295, 0.39577052564620974, 0.3907238619709015, 0.3865441122055054, 0.38114741786003115, 0.3788669383430481, 0.38275434657096863, 0.37853023329734803, 0.37564239365577695, 0.36594150688171384, 0.3773051337528229, 0.37084892243385315, 0.3677695250415802, 0.36579051460266115, 0.3681923508548737, 0.368883288564682, 0.3612462426280975, 0.3631409015369415, 0.35766538179397583, 0.3531649662780762, 0.3558689317512512, 0.35157216665267943, 0.3500805833721161, 0.3557775838661194, 0.35045433807373044, 0.3611171048164368, 0.3416230324459076, 0.34602636832237244, 0.3530104401874542, 0.3466361516475677, 0.3390077588367462, 0.33808932596206664, 0.34345315816879274, 0.33856526750564575, 0.34119949674606326, 0.33200204756736756, 0.34682175961494444, 0.33221679213523864, 0.3356236516189575, 0.3342136119270325, 0.3318937533569336, 0.32736872631073, 0.33273986531257627, 0.32798031144142153, 0.3345370144748688, 0.3221112571620941, 0.3294124867630005, 0.32295630917549134, 0.32388019207000734, 0.33426882071495057, 0.31743750168800355, 0.3203463721370697, 0.3205648868465424, 0.31726549599647524, 0.3207501841545105, 0.32127288001060483, 0.2731207026767731, 0.2544901631975174, 0.24852916284561158, 0.24385207886695862, 0.2391368235015869, 0.2341852138710022, 0.22841455592155457, 0.22207941299915313, 0.21485547091007232, 0.20664831663131714, 0.19766962342262268, 0.1877753803682327, 0.17716978083610535, 0.16591846782684327, 0.16091871908664704, 0.15465354897975922, 0.1505858787202835, 0.145825661277771, 0.14128961040973664, 0.13648335669517517, 0.13103979667663573, 0.13027385828495025, 0.1266269242310524, 0.12201083226680756, 0.11953304838895798, 0.11724292030334472, 0.11712147625923157, 0.11385422418355942, 0.11114071168422698, 0.10964708163499833, 0.10812293177366257, 0.10569615104913711, 0.10531856090068817, 0.10546646834611893, 0.10154414256095887, 0.09950422924995422, 0.09759622812271118, 0.09545504578351975, 0.09658233951568604, 0.09814460894107818, 0.09366498131513595, 0.0928860460448265, 0.09240659741163254, 0.09210402688026428, 0.0917929681777954, 0.0915486490893364, 0.09132206210374832, 0.09093127651453019, 0.09063782224178314, 0.09016139040231705, 0.08972128591299057, 0.08925230623960495, 0.08866669276714324, 0.08800300784349442, 0.08728225311040878, 0.08645394740581512, 0.08555300506353378, 0.0846132123374939, 0.08358727492570878, 0.08248181581020356, 0.08125422147274017, 0.08007195839643479, 0.07900990246772766, 0.07795043254375458, 0.07693502678155899, 0.07595396322727203, 0.07489161292314529, 0.07370513483524323, 0.07238668488740921, 0.0709465494465828, 0.06940515860557556, 0.06780708044052124, 0.0662651832652092, 0.06492004828691482, 0.06381396834135056, 0.0628251629459858, 0.06185790657639503, 0.0608221838259697, 0.05976126450657845, 0.05866470957875252, 0.05805117971301079, 0.05796062170743942, 0.057851472529172894, 0.05775514709353447, 0.05764590355634689, 0.05753194870710373, 0.05742254934668541, 0.05729745507955551, 0.05717630119204521, 0.05706603768825531, 0.05695591757059097, 0.05684136286854744, 0.05670826433897019, 0.056596336191892624, 0.05651217339634895, 0.056426943531036375, 0.0563748759162426, 0.05631527554988861, 0.056255267258882524, 0.05619195619463921, 0.056150301368236545, 0.05610339669942856, 0.056066812883615494, 0.0560241160941124, 0.055983450301885604, 0.05593627968072891, 0.055872196801900864, 0.0558198485827446, 0.05577004077553749, 0.055707637301683426, 0.05565029400348663, 0.055583431787490846, 0.05552605385422706, 0.055464074062108994, 0.05539025269985199, 0.0553151453256607, 0.055236451193094255, 0.055163867008686064, 0.055084034523963925, 0.0549962942814827, 0.05491676008939743, 0.054827218585014346, 0.05475038407087326, 0.054674518781900404, 0.05460020678639412, 0.054527113848924634, 0.05445477641940117, 0.05437830322623253, 0.05432863743185997, 0.05425238547682762, 0.05421078539848328, 0.05414377074480057, 0.05408199003815651, 0.054019475688934324, 0.053943164632320406, 0.05386177031159401, 0.05377441480875015, 0.05369041188716889, 0.053612876980304716, 0.05354219555974007, 0.05347869487047195, 0.05342358604669571, 0.053366013548374176, 0.05330664221644402, 0.05324842044353485, 0.05317801698088646, 0.053103874597549436, 0.05302509736537933, 0.0529464650952816, 0.052882278300523756, 0.05280893135547638, 0.05273642329096794, 0.05267309969425201, 0.05260882685661316, 0.05254775462627411, 0.052484564324617386, 0.052412560096979144, 0.05234392374753952, 0.05227115735530853, 0.05219803556799889, 0.052127605043649675, 0.052072774217128755, 0.052003290840387344, 0.05193943342804909, 0.05189221285939217, 0.05183311367869377, 0.05177632029891014, 0.05171277920007706, 0.05164795881867409, 0.05157098463892937, 0.051498047529459, 0.05142568842291832, 0.05134720743775368, 0.051266034467220306, 0.05117509130120278, 0.05108609638094902, 0.050995337170362476, 0.05090987221121788, 0.050833999676704406, 0.050749552204608916, 0.05066691404461861, 0.05058825654745102, 0.05050605076551437, 0.050421635464429855, 0.05034103973865509, 0.050258779375553134, 0.050177476674318315, 0.050096553486585614, 0.05002298685669899, 0.04994887238383293, 0.049876302379369734, 0.049805063710212705, 0.04972891459107399, 0.049644819684028625, 0.04956575127124786, 0.049483092406988144, 0.04940235688686371, 0.04932668349862099, 0.0492726494204998, 0.04918169334173202, 0.0491525986301899, 0.04909651041507721, 0.04905288620233536, 0.04900891456127167, 0.04895797687768936, 0.04891017641067505, 0.048859518704414365, 0.04880877669453621, 0.04874986200928688, 0.04869002415537834, 0.048620594038963315, 0.04855670321583748, 0.04848852786064148, 0.048420415128469466, 0.04834590547323227, 0.04826872490882873, 0.048187113120555874, 0.04812609768033028, 0.04806241552710533, 0.047997767454385755, 0.04793508046388626, 0.04786665198564529, 0.04780351601958275, 0.047738395986557006, 0.047669519010782244, 0.0476140491604805, 0.04754618884325027, 0.04748798651456833, 0.047427491459846496, 0.04736524562478066, 0.04731021750330925, 0.0472477265894413, 0.047186212503910065, 0.04713451199531555, 0.04707647787451744, 0.04701271393060684, 0.04696989503979683, 0.046914276020526884, 0.0468682282602787, 0.04681415134906769, 0.046760631129741666, 0.04671284143328667, 0.04665652614593506, 0.04660284528613091, 0.04653406430482864, 0.046474715809822084, 0.04641763925552368, 0.04636077364683151, 0.04630145649909973, 0.04625450656056404, 0.0462111004447937, 0.04615473912000656, 0.04610314262032509, 0.046062751702070234, 0.0459962634909153, 0.04594848521709442, 0.04589202344059944, 0.04583682352423668, 0.045787184451818466, 0.04572274905204773, 0.045661605010032656, 0.04560422537684441, 0.04552887197971344, 0.04546008479952812, 0.04538130792498588, 0.04530370507001877, 0.04522038256764412, 0.04513935950517654, 0.04505649978041649]
v100_betas.append(estimate_loss(x, y, 44))

y = [2.071393103981018, 1.449956836013794, 1.2013241567230224, 1.0395054733848572, 0.9207793700790405, 0.8393920854949951, 0.7675190677070618, 0.7094752498435974, 0.656045449848175, 0.6190483523654938, 0.5838833296775818, 0.5494831143188477, 0.5274501501274109, 0.5058635122585297, 0.47810353207588197, 0.4725480876064301, 0.45187732551574705, 0.4461756125545502, 0.44221168003082273, 0.4293457468509674, 0.4286943851947784, 0.4148880595397949, 0.4136022854328156, 0.41340140480041504, 0.40722288854599, 0.40362804720878603, 0.3948440229034424, 0.3947272729492188, 0.39561560572624205, 0.38975582783699037, 0.3836001559829712, 0.384247163105011, 0.3762365138053894, 0.374904843788147, 0.37736884286880495, 0.36918403162956237, 0.36623041087150576, 0.3744420236492157, 0.3626794741535187, 0.3615289476966858, 0.36441621215820313, 0.3620060235977173, 0.3542986608600616, 0.3534362522792816, 0.36307648034095763, 0.35893428754806517, 0.34816979599952697, 0.35380941480636596, 0.3526416176605225, 0.34563022388458253, 0.35040667892456057, 0.33424570576667784, 0.35174616270065306, 0.34440396215438845, 0.33757842266082766, 0.3403436104774475, 0.3426866645145416, 0.3399161440849304, 0.334919688873291, 0.336861409740448, 0.32573556060791015, 0.33405172808647154, 0.3351759710884094, 0.32350420647621153, 0.3350747524356842, 0.3292681862163544, 0.33076812348365786, 0.32948361941337584, 0.3267829774475098, 0.3194968911933899, 0.3205408319759369, 0.32101616859436033, 0.32056602900505066, 0.3270660910129547, 0.3222018588542938, 0.32084952882766726, 0.3140232540225983, 0.31551267358779905, 0.3261042612838745, 0.3095298014354706, 0.3182154359149933, 0.2714046342182159, 0.2514445837688446, 0.24562196633338929, 0.24059640190124512, 0.23578101578712463, 0.23037869610786438, 0.22426221546173095, 0.21751578407287597, 0.20975978715896607, 0.2010575908613205, 0.19138019824028016, 0.1814547229528427, 0.17096289008617402, 0.1630169509601593, 0.15687968690395354, 0.15032590850353242, 0.14485332538127899, 0.1398908840894699, 0.13602765305519104, 0.13268674140453338, 0.12865098774909972, 0.12495025331497192, 0.12341688113451003, 0.12052922582149506, 0.11687419134616851, 0.11360541129350663, 0.11021403034448624, 0.1064315595459938, 0.11050860550165176, 0.10453487458705903, 0.10228734448671341, 0.10026154037237167, 0.09881599532604217, 0.09655725780248642, 0.09537555782794953, 0.09727035059690475, 0.09384728946208953, 0.09186834215402603, 0.08985439183950424, 0.08862644852876664, 0.08766109942436218, 0.08710776251077652, 0.08682624519586563, 0.08644127725601196, 0.08617408947944641, 0.08579711977005004, 0.08541393038749695, 0.08498709700345992, 0.08444804951190948, 0.0838614692401886, 0.08322282933950424, 0.08251429569959641, 0.0816964218211174, 0.08081578971385955, 0.07983410968780517, 0.07875596045970917, 0.07759529819011689, 0.07634171314239502, 0.07506368035554886, 0.07383638814687729, 0.07271899525880814, 0.07160106002569198, 0.07049603892326355, 0.06946749554395676, 0.06840142954111099, 0.0672541692852974, 0.06608321752786636, 0.064956441822052, 0.06383893320322037, 0.06270331782460213, 0.06157258340835571, 0.060484113429784776, 0.05939922379493713, 0.058292115026712416, 0.05736129606842995, 0.05673100902915001, 0.05619947275519371, 0.05568960890889168, 0.05510666696071625, 0.054476462001800535, 0.05411764724135399, 0.054031966984272005, 0.05395886446595192, 0.053885204272270205, 0.053795585317611694, 0.05370639292836189, 0.05360842082381249, 0.053500387068986896, 0.053389499199390414, 0.053271031379699706, 0.05315220460534096, 0.05304735787630081, 0.05294552597522736, 0.05285146597027779, 0.05274412662625313, 0.05263394914746285, 0.05252316744446754, 0.052391945796012876, 0.05226824065923691, 0.05215190333724022, 0.052060964307785035, 0.05200455461502075, 0.05195294474482536, 0.05188871712446213, 0.05183284155130386, 0.05178043287396431, 0.05172683206796646, 0.05168086267232895, 0.05161673593521118, 0.051556239401102065, 0.05150836795568466, 0.05144485580444336, 0.051383411791324614, 0.05131996315956116, 0.05125386903762817, 0.051186107240915296, 0.051109295309782025, 0.05103163957834244, 0.05095091220021248, 0.050874865310192106, 0.05079842112898827, 0.050731239475011826, 0.05067981851816177, 0.050630647311210634, 0.05056923426628113, 0.050505014252662656, 0.05043808986783028, 0.05037728240132332, 0.05030845326900482, 0.05024574038147926, 0.050181079667806626, 0.050116655668020246, 0.05005776944756508, 0.04999973206520081, 0.04993774375796318, 0.04987561066746712, 0.049851320049762726, 0.049774791692495345, 0.04973404425740242, 0.049691574612855914, 0.049644217048883436, 0.04959386223554611, 0.049546002482175826, 0.049491772595643996, 0.049435692373514174, 0.049377115148305895, 0.0493158929169178, 0.049250515676736835, 0.04918692576289177, 0.04912560322523117, 0.049068660682439806, 0.0490105073094368, 0.0489573185300827, 0.04889736033916473, 0.04883886230230331, 0.048770290704965594, 0.048708652588129044, 0.04864280405163765, 0.04857427525401115, 0.04851297547698021, 0.04844766064763069, 0.048385029766559604, 0.048314526913166046, 0.048243683100938795, 0.0481796251142025, 0.048118699744939805, 0.04805708967447281, 0.04798827043414116, 0.0479271387219429, 0.047865406265258786, 0.04779370782136917, 0.0477205886900425, 0.04767377819776535, 0.047601056205034256, 0.04756167808294296, 0.04751739781022072, 0.047462026591300964, 0.047404192993640897, 0.047347964942455294, 0.04727936037540436, 0.047212242074012756, 0.04715083441257477, 0.047084890865087506, 0.04702644466042519, 0.04696031754732132, 0.0468983151435852, 0.0468264208650589, 0.04675826022863388, 0.04668963067412377, 0.046622361624240875, 0.046558439152240755, 0.046497996180057524, 0.04642973381400108, 0.04637556955933571, 0.04631356885194778, 0.046266349081993105, 0.046208296893835064, 0.046152689126729964, 0.04610810570716858, 0.046056188522577285, 0.04601404241681099, 0.04596624564647674, 0.04591680033922196, 0.045865360946655276, 0.04581650468826294, 0.045762204562425614, 0.04570230304956436, 0.045682825158834456, 0.04561596779108047, 0.04558736117243767, 0.04555581573486328, 0.045523004021644595, 0.0454766148686409, 0.04545300941944122, 0.045409541372060776, 0.04536081632137299, 0.04531753556728363, 0.045265526915788654, 0.04521460602641106, 0.04515769653916359, 0.045092745126485825, 0.045028227632045746, 0.04496809160232544, 0.0449039722597599, 0.044839184857606885, 0.04476806080102921, 0.044696483736038205, 0.04463085773825645, 0.04456687406420708, 0.04451118948698044, 0.044465528386831286, 0.044409726022481916, 0.044360284699201585, 0.04431105092048645, 0.044253064153194424, 0.044197753598690034, 0.044152016172409055, 0.04409541580080986, 0.04405239769101143, 0.044004965029954914, 0.04394969323992729, 0.04392265588402748, 0.04386912262558937, 0.04382947357177734, 0.04378614942312241, 0.04373586884260178, 0.04368673677563667, 0.04363197515130043, 0.04357290011882782, 0.04351884130358696, 0.043455077548027035, 0.04339334350705147, 0.0433322209084034, 0.04326589131951332, 0.04319634687781334, 0.04313702032327652, 0.04306854895830155, 0.043001630541086196, 0.04293699938058853, 0.0428739129948616, 0.04281462074995041, 0.04276393890619278, 0.04271044862389565, 0.042684062632322314, 0.042648154705762865, 0.04260684022784233, 0.04257062307357788, 0.042523490844964984, 0.042472191780805586]
v100_betas.append(estimate_loss(x, y, 56))

print("-----------------------------------")

# P100
y = [1.546550467262268, 1.149850545539856, 0.9884862126541137, 0.8693271953392029, 0.7796731099128723, 0.706069649143219, 0.6487923616790772, 0.5907332665634155, 0.5475414258956909, 0.5025675612258911, 0.4604364088821411, 0.4316860270690918, 0.4041174667072296, 0.3756252749919891, 0.36005232944488524, 0.3462153636550903, 0.33763117520332336, 0.32484539262771606, 0.31554380859375, 0.3092333574771881, 0.30733202138900756, 0.3052877136993408, 0.2976372702026367, 0.298615058259964, 0.29329689213752747, 0.29605999608039857, 0.29138881629943847, 0.2937954433917999, 0.2873350283718109, 0.2905882141304016, 0.2872471745300293, 0.28739096305847167, 0.2812320648574829, 0.28136192091941836, 0.2848731905078888, 0.2881156070613861, 0.281849409570694, 0.2833040540409088, 0.2786356479740143, 0.27670767780303956, 0.2952021356201172, 0.2790516308784485, 0.2820782946586609, 0.2746030741691589, 0.28225138551712037, 0.2729098494911194, 0.2783173435688019, 0.2831729467010498, 0.2782534485435486, 0.27528237424850466, 0.27275089453697204, 0.27511951363563536, 0.27719910301208495, 0.2755901408958435, 0.27457040174484254, 0.27738584890365603, 0.2724510002326965, 0.27096279973983767, 0.28031145971775057, 0.27526332032203676, 0.27151340432167054, 0.2729918726158142, 0.2729048801231384, 0.2679266039943695, 0.26478303565979006, 0.2791914328479767, 0.2722392095947266, 0.2618963890933991, 0.27269250020980834, 0.27246259959220887, 0.2662942755126953, 0.26583589416503906, 0.2587323162460327, 0.27011938678741454, 0.26861370953559877, 0.27277819995880126, 0.25725083409309385, 0.26999211006164553, 0.2675389106082916, 0.26057368854522706, 0.27226004769325257, 0.22417131779193877, 0.20661745697021483, 0.20212189929008484, 0.1987516571521759, 0.19601236698150634, 0.1933248085975647, 0.19031205330848694, 0.18695676528453828, 0.1832029332447052, 0.17884485925197602, 0.1740334730863571, 0.16853224868774414, 0.16235081248760225, 0.1555304814529419, 0.148340634765625, 0.14087442932605743, 0.13695650554180144, 0.13202124251842498, 0.12794726340293885, 0.12452409699678421, 0.1204111843252182, 0.11626928395986558, 0.11260265892744065, 0.11225484155654908, 0.10863387794017791, 0.10589878450632095, 0.10395095348358155, 0.10165248213291168, 0.0991462467622757, 0.09622941848754883, 0.09310289407968521, 0.09634723257541657, 0.0922396178984642, 0.0905433296918869, 0.08841068396329879, 0.08700574594974518, 0.08566664187431336, 0.08394558897018432, 0.08293979276657104, 0.08776042983055114, 0.08231670896530151, 0.08157125180482865, 0.08136746474504471, 0.08107686836481094, 0.08091875242233276, 0.08070107471466065, 0.08051580068111419, 0.08022293717384338, 0.08000718306541443, 0.07966537676572799, 0.07937652244567871, 0.07902181123018265, 0.07862739971399307, 0.07819538587331772, 0.07771377224206924, 0.07719744134664536, 0.07661739476203919, 0.07607069610357285, 0.07548530727624893, 0.07491240752220153, 0.0743136884522438, 0.07371429767370224, 0.073106508705616, 0.07244646310329438, 0.07176400888681411, 0.07106178729772568, 0.07032105444192886, 0.06950569316387177, 0.06864146945714951, 0.06777893598556518, 0.06696365924835206, 0.06622594344139099, 0.06550285212278366, 0.06478035714864731, 0.06402207435131073, 0.06325364768266678, 0.06243037320017815, 0.06159468993902206, 0.06075625420331955, 0.05992636947631836, 0.059466062700748445, 0.05937894235491752, 0.05926936431646347, 0.0591784473824501, 0.059065895167589186, 0.058954443016052245, 0.05885626036405563, 0.05874180271625519, 0.058626278527975084, 0.05852328502416611, 0.0584052816426754, 0.05830189731836319, 0.05820227570652962, 0.05810329702973366, 0.0580061991238594, 0.05790954575181007, 0.05782756719827652, 0.05771387452363968, 0.05760922001123428, 0.057495266131162646, 0.05740838651776314, 0.05733929064273834, 0.05727840550541878, 0.05722490464091301, 0.05718200528621674, 0.0571446149802208, 0.05708491112112999, 0.05705304728865623, 0.05700080934762955, 0.056964682724475864, 0.056918907442092895, 0.05687358748435974, 0.05684039882779121, 0.056781245102882384, 0.05673876375794411, 0.056694053118228914, 0.05663870548605919, 0.05659964920759201, 0.05655217597961426, 0.05649360035657883, 0.056456715122461316, 0.05641483864665031, 0.0563692736530304, 0.05632254008293152, 0.056280500853061674, 0.05625129203796387, 0.05620114969015121, 0.05616316157579422, 0.056134069559574125, 0.056097924010753634, 0.056056733033657075, 0.05601318826198578, 0.055994464634656904, 0.05596007140398025, 0.05591280321598053, 0.05588269161462784, 0.05585810183286667, 0.05583594413638115, 0.05579737893342972, 0.0557753444314003, 0.05573255103111267, 0.05569779227614403, 0.05565394566297531, 0.05560653474211693, 0.05557382835507393, 0.05553422190070152, 0.05549555639028549, 0.05546055041790009, 0.05541820482730866, 0.05537208301901817, 0.05532826156139374, 0.05529854896068573, 0.055245062894821166, 0.05520028503894806, 0.0551607989859581, 0.055101221994161606, 0.05505366175055504, 0.055009950602054596, 0.05495440831899643, 0.05490223574757576, 0.05484797333002091, 0.054796018571853636, 0.05475286698818207, 0.05468815678238869, 0.05465622868061066, 0.05460979287266731, 0.05455520758509636, 0.054517177085876466, 0.05447824447989464, 0.05443158541917801, 0.054380281254053114, 0.0543287997841835, 0.05427633313417435, 0.0542220635509491, 0.05417994746088982, 0.05413831673145294, 0.05408510264158249, 0.05402867280483246, 0.053977344443798064, 0.05393709625959396, 0.05389346243262291, 0.0538347457754612, 0.053801068181991575, 0.05375663952231407, 0.05371197471618652, 0.05366999657869339, 0.053621092410087584, 0.05356951736807823, 0.05352726714849472, 0.05346408684372902, 0.053412971462011335, 0.05337837290644646, 0.0533189182639122, 0.053278947491645814, 0.05322963298201561, 0.05317036191463471, 0.05312606503248215, 0.0530699755346775, 0.05302478731274605, 0.05297346956133842, 0.052926760351657866, 0.052889788844585416, 0.05283039045572281, 0.052774265644550324, 0.052735333099365234, 0.05269143206954002, 0.05264433695793152, 0.05258671070933342, 0.052536479729413985, 0.052487647068500516, 0.052436647013425826, 0.05239728816509247, 0.05234560492515564, 0.052295838124752046, 0.052257443218231205, 0.05220128548383713, 0.05215777723670006, 0.052109497760534286, 0.05207999609589577, 0.052019430661201474, 0.05198719021677971, 0.05193166875958442, 0.0518854517185688, 0.051841866998672485, 0.05178636512517929, 0.051732130229473115, 0.05168428627848625, 0.05163667821407318, 0.05159388682603836, 0.05155232517004013, 0.05150680318832397, 0.05146469634532928, 0.051431799325942995, 0.051389427522420886, 0.05134312805891037, 0.05132491800665855, 0.05127985190629959, 0.05124685170531273, 0.05121549827694893, 0.0511850955414772, 0.05114520088195801, 0.05111258119940758, 0.05107678462266922, 0.05102849854469299, 0.0509935460627079, 0.050947214851379395, 0.05089926558017731, 0.05084699747562409, 0.05080737534880638, 0.05075964811682701, 0.050709457339048386, 0.0506657005572319, 0.05063049307107925, 0.0505825630056858, 0.050535359140634534, 0.05048770169973373, 0.05044337266921997, 0.050394360818862914, 0.05034713129281998, 0.050296021844148636, 0.05025610792994499, 0.05020418552994728, 0.050157305400371555, 0.05010810392618179, 0.05005319788098335, 0.050011730976104736, 0.04995864789247513, 0.04989677062392235, 0.04983966505765915]
p100_betas.append(estimate_loss(x, y, 20))

y = [1.671692392692566, 1.2240715343856812, 1.0206555828475952, 0.8765305712318421, 0.7774627213287354, 0.705139649734497, 0.6378280401229859, 0.5900065604019165, 0.5367448307418823, 0.4977610277366638, 0.46552189383506776, 0.4339421029663086, 0.41261945507049563, 0.3862715711593628, 0.38097819326400756, 0.36796413536071776, 0.35751338315963743, 0.3459975132846832, 0.3433431858921051, 0.34148607233047484, 0.3287980701160431, 0.32944585332870485, 0.3248153338432312, 0.32679974798202516, 0.33079890778541565, 0.31987577872276307, 0.31899208941459656, 0.3195485759735107, 0.3112899916267395, 0.32224667070388796, 0.3213162326431274, 0.3049770598220825, 0.31544275449752807, 0.31039201183319093, 0.31016159112930297, 0.3127329568004608, 0.3122821270751953, 0.3071083697319031, 0.30431895107269286, 0.3067891798210144, 0.3147992977714539, 0.30436779712677003, 0.30498966609954836, 0.302136496925354, 0.31420204070091245, 0.30067999077796936, 0.3044375963783264, 0.29359270554542544, 0.30176184165000913, 0.3074208172798157, 0.2910230645084381, 0.3011660977935791, 0.30529853534698487, 0.29004722436904906, 0.29610074069023135, 0.30640826795578, 0.2958109975147247, 0.2921815658760071, 0.3047801450920105, 0.2883724718475342, 0.2930356298828125, 0.295735813331604, 0.2880234223079681, 0.29153455583572385, 0.2876859439373016, 0.3053658728313446, 0.28315699085235596, 0.29251009031295777, 0.2856018837547302, 0.2842189063644409, 0.29020267534255983, 0.2912719211769104, 0.2846229494857788, 0.2902067306518555, 0.2902342681312561, 0.27575438420295717, 0.2857309240913391, 0.28253300149917604, 0.28077368682861326, 0.2775119031238556, 0.2920600548839569, 0.2404163999938965, 0.22250356514930725, 0.21761551643371582, 0.21460413138389586, 0.21107139696121216, 0.20761537907600403, 0.20408769313335418, 0.20003962499141692, 0.19538307948589326, 0.1901782827281952, 0.18424492230415343, 0.177672310628891, 0.17030068946838378, 0.16309994268894196, 0.15715942679405212, 0.15077122289657593, 0.14474888261795044, 0.13944163719177247, 0.13668349325180054, 0.1327203795671463, 0.12909331933021545, 0.12601193094730379, 0.12284850013971328, 0.1196788177394867, 0.11746826894044876, 0.1152283343076706, 0.11369806293964387, 0.1110991294336319, 0.1086181600189209, 0.10624883662939072, 0.10386055717229843, 0.10100425394535065, 0.10129079545974731, 0.10211578770160674, 0.09736853542804719, 0.09559790360927582, 0.09435877892494202, 0.09273494576931, 0.09142462190151214, 0.09004177929162979, 0.08894716769218444, 0.08847649456262588, 0.08815987956047058, 0.08784870779514313, 0.08757291477203369, 0.08722819525718689, 0.08686188564062118, 0.0864914802122116, 0.08601850184202194, 0.08551828148841858, 0.08496311513900758, 0.08439586188793183, 0.08373111624717712, 0.08304426062583924, 0.08229529321432114, 0.0814888492321968, 0.08065196574687958, 0.07981897443771362, 0.07898968632936477, 0.07824474963665008, 0.07744580479621888, 0.07656407895326614, 0.0756310336637497, 0.0745883702325821, 0.07348002224206925, 0.07227180070161819, 0.07106293158054351, 0.06986919588804245, 0.06865153601408004, 0.06752653324842453, 0.06658322422027588, 0.0657474640417099, 0.06492643965244294, 0.06409316214561463, 0.06335336893081665, 0.06271116039991378, 0.062038925194740295, 0.06134663271784782, 0.06061585357189178, 0.05981854194045067, 0.059353566582202914, 0.05929214126944542, 0.059198753006458285, 0.05912170873641968, 0.059037008234262466, 0.05895251864314079, 0.058857347925901415, 0.05877195189833641, 0.05866386647462845, 0.058579834985733034, 0.05846911282658577, 0.05838973341703415, 0.058309950547218325, 0.0582311503469944, 0.05814191967248917, 0.05804378989458084, 0.0579325198674202, 0.05784035061001778, 0.057748425390720365, 0.05763467509746552, 0.05757109872937202, 0.05751541932582855, 0.05746315560936928, 0.057426805365085605, 0.0573682111954689, 0.05732174488663674, 0.05728493529438972, 0.05723859871149063, 0.05721181938648224, 0.05716899829030037, 0.057142106502056124, 0.05709873243808746, 0.05707136440992355, 0.057027518327236175, 0.056991169106960296, 0.056943051505088806, 0.05690453754544258, 0.05685196590900421, 0.056801596549749374, 0.05675185354590416, 0.05669829584121704, 0.05664702405452728, 0.056582273080348966, 0.05653207482337952, 0.05648065065026283, 0.05641643814921379, 0.056367458987236024, 0.05632213845491409, 0.05626868971467018, 0.056222689909934995, 0.0561650427532196, 0.05612017895698548, 0.05605672122120857, 0.056010145428180697, 0.055954036115407946, 0.0559000320649147, 0.055842872577905656, 0.05580056504011154, 0.055740461447238925, 0.05569690579175949, 0.05564182929754257, 0.055582439093589786, 0.05554965216755867, 0.05549185483336449, 0.05545391649007797, 0.05540694540500641, 0.05535920659542084, 0.055303993519544604, 0.05526229535579681, 0.055212081751823426, 0.05514998944878578, 0.05509522728919983, 0.055046650698184964, 0.05498706129312515, 0.05493102958679199, 0.05488284380197525, 0.054821678541898726, 0.054776571050882336, 0.054732803159952166, 0.05467593549728394, 0.054630294976234436, 0.054572781566381456, 0.05451781421303749, 0.05445307546138763, 0.05440176914453507, 0.05434103893756866, 0.05428533911943436, 0.0542259788942337, 0.054178724542856216, 0.054131414951086046, 0.05408518938422203, 0.05403301557779312, 0.053971233377456664, 0.053923182466030124, 0.05386946446657181, 0.05380663277864456, 0.053760836851596834, 0.053714597206115725, 0.05365867083311081, 0.05360715887069702, 0.0535640862429142, 0.053512364480495456, 0.05346510180234909, 0.053407085044384, 0.05335128717184067, 0.053288682498931886, 0.05323146391630173, 0.05317511131763458, 0.05312464008688927, 0.05307347321510315, 0.05304310130119324, 0.05300261338114738, 0.05295631720781326, 0.052921350606679914, 0.052868404883146286, 0.05284669660210609, 0.052798790328502654, 0.05276601552009583, 0.05271501854658127, 0.05267431135058403, 0.05262517498373985, 0.05258510443091392, 0.05254970593094826, 0.0524934405708313, 0.05244016297340393, 0.052406592515707014, 0.052358892610073086, 0.05231717456817627, 0.05226526777982712, 0.052220654646158216, 0.05217125704526901, 0.052116669809818265, 0.05206268302202225, 0.05200382129430771, 0.05195119741201401, 0.051891636691093444, 0.05183961923122406, 0.051786047630310056, 0.051727834085226056, 0.051677795748710634, 0.05161380673408508, 0.05156350584387779, 0.051505664542913436, 0.05144125671029091, 0.05140158607840538, 0.05134246232748032, 0.05128838051557541, 0.05124569687485695, 0.051187208775281906, 0.051151432199478146, 0.05109352229595184, 0.051047016005516054, 0.05099767921686173, 0.05094507218003273, 0.05090073785543442, 0.05086179955244064, 0.05079736580133438, 0.050767779129743576, 0.05072488232851029, 0.05067751136779785, 0.05064760096669197, 0.050592895073890684, 0.05055093078017235, 0.05050575621843338, 0.05045876928091049, 0.05041894632101059, 0.050379650783538815, 0.05033285199046135, 0.05029300654649734, 0.050257816033363344, 0.050227868437767026, 0.05018194240570068, 0.05013846247076988, 0.050104827110767365, 0.05009110372066498, 0.05003683603405953, 0.05001497317552567, 0.04997352239370346, 0.04995271387338638, 0.04992625221967697, 0.04988933282136917, 0.049849802803993225, 0.049825198085308074, 0.049779504890441896, 0.04974168200492859, 0.04970213725805282, 0.04965812555193901, 0.04960575910687447, 0.049570639021396634]
p100_betas.append(estimate_loss(x, y, 26))

y = [1.6665156839370727, 1.2409103422546386, 1.0317372874832154, 0.8928479343795777, 0.7989962688827514, 0.7194619658088685, 0.6534556370162964, 0.6032016915130616, 0.5551643651199341, 0.5192647049999237, 0.4854585131931305, 0.45782352310180663, 0.4382306087112427, 0.4055911617946625, 0.40317259622573853, 0.39381902130126956, 0.37574427761077883, 0.3764554214859009, 0.36194708895683286, 0.3637943392944336, 0.3631272890663147, 0.3648290126037598, 0.34685220014572143, 0.3535242900085449, 0.3438697424888611, 0.3539136873626709, 0.33438937574386596, 0.34492551818847655, 0.3427713769721985, 0.3450531282424927, 0.3381451394081116, 0.3488997793197632, 0.33265472721099854, 0.34690208557128904, 0.32640007495880125, 0.33503485929489135, 0.3324491760826111, 0.33453594509124757, 0.3178210899448395, 0.3368081317138672, 0.32695424997329714, 0.3264011621665955, 0.32668894929885867, 0.3287603503036499, 0.31963998351097106, 0.3226788570022583, 0.3290160396003723, 0.3083482322692871, 0.33020831954002383, 0.32026097396850584, 0.3163274283409119, 0.32581192902565004, 0.3112534076786041, 0.3229141400718689, 0.3096997996711731, 0.31868815172195436, 0.3187590749073029, 0.31213025912284853, 0.31222092535972595, 0.30469014435768127, 0.31183562271118165, 0.30992492001533506, 0.30678533782958983, 0.3103133526325226, 0.3014776694869995, 0.31417129781723024, 0.30216768246650694, 0.3013865052223206, 0.30474016753196714, 0.30405485921859743, 0.3047500084114075, 0.30751877938270566, 0.29747698698043823, 0.31129240375518796, 0.2936346694946289, 0.2994671873283386, 0.30867035771369933, 0.2949338087272644, 0.29884977310180666, 0.297587976732254, 0.29346374097824096, 0.25576786193847656, 0.23484433983325959, 0.22946354555130005, 0.22559394114494324, 0.22202943031787872, 0.2181605749320984, 0.21372450557708741, 0.2086732901954651, 0.2031180944442749, 0.19678198827266694, 0.1896238369178772, 0.18155853870391847, 0.17304548866271974, 0.1640309585905075, 0.154763633518219, 0.14895287034988403, 0.14480657867908478, 0.13982336480140686, 0.13604853249549867, 0.13218562571525574, 0.1281116772556305, 0.12375296639919281, 0.12383037427663802, 0.1204665683913231, 0.1169891309261322, 0.11485086735248566, 0.11211929075717926, 0.11060060669898987, 0.11020658920288086, 0.10764670224189758, 0.10536493447065354, 0.10321953283786774, 0.10103278397321701, 0.09861501913547516, 0.1013740161728859, 0.09965152862548828, 0.09647923285007477, 0.09420173085212707, 0.09260505724430085, 0.09105060102701187, 0.08997860260486602, 0.08972589643001556, 0.08947349530220032, 0.08915162719249725, 0.08877952192306518, 0.08834395293474197, 0.08780706248760223, 0.0872034569644928, 0.08650619614362717, 0.08568789813995362, 0.08474243772029877, 0.08366834830284119, 0.08247767507791519, 0.08116597738742828, 0.07985349395275115, 0.07854368223190307, 0.07719367371082306, 0.07575127495765686, 0.07427533488750458, 0.07275080475330353, 0.07122405866622925, 0.06991538710594178, 0.06862778712034226, 0.06728486311912536, 0.06590804723262787, 0.06473267977237701, 0.06373797833919526, 0.06275661202907562, 0.061896542096138, 0.061066373918056485, 0.06025734832763672, 0.05946610109210014, 0.05862471395373344, 0.05777003228545189, 0.05697689668893814, 0.056379237195253375, 0.055876752034425735, 0.055374602971076964, 0.05484229521512985, 0.054239519463777544, 0.05388778187274933, 0.053812726780176165, 0.05373718500137329, 0.05365075028657913, 0.0535628093457222, 0.05346948643684387, 0.05337715806722641, 0.05326222239255905, 0.0531597902238369, 0.05303764889240265, 0.05292743558168411, 0.052820360263586046, 0.05273228855967522, 0.05263552600622177, 0.0525427623975277, 0.05246126119613648, 0.052371998510360715, 0.052290620874166485, 0.05220916499614715, 0.052127748391628266, 0.052055500671863555, 0.05201316334843636, 0.051969408643245694, 0.05190577161312103, 0.05185239240884781, 0.05179203983545303, 0.05172777121067047, 0.05165907772064209, 0.05159087427377701, 0.05153544804215431, 0.05147523207068443, 0.051424815279245376, 0.05137027114868164, 0.05131915404677391, 0.051269584314823154, 0.05121188259124756, 0.05115444128274917, 0.051101460415124894, 0.051029170224666597, 0.05097794596195221, 0.05092683425664902, 0.05086750443816185, 0.05081082019329071, 0.05076009132862091, 0.05070670190930367, 0.05065440085291863, 0.050602954471111294, 0.05053870756149292, 0.05047911298155785, 0.05041480571389198, 0.05035551781773567, 0.05028816502690315, 0.050225908250808714, 0.05016004668831825, 0.05009222732067108, 0.05003231358766556, 0.049966107585430145, 0.04990426559567451, 0.0498398451256752, 0.04979024723649025, 0.04974662014722824, 0.04968371005535126, 0.049639353291988375, 0.049586507855653765, 0.04953680143475533, 0.049481223055124285, 0.049422702106237414, 0.04936307555794716, 0.049303513280153276, 0.049247102768421175, 0.04919679650425911, 0.049141383694410325, 0.04909170960664749, 0.04903603121757507, 0.048988260841369625, 0.048932313755750655, 0.04887835618019104, 0.048821164379119875, 0.04876509428977966, 0.048705035073757175, 0.04864891904473305, 0.048596628212928775, 0.0485835773229599, 0.04853101948976517, 0.048496288920640944, 0.0484555511200428, 0.04842510506033897, 0.04838031133651734, 0.04833878491282463, 0.048292662179470064, 0.048247633528709415, 0.04819155852913856, 0.04813588721990585, 0.04807991636276245, 0.04802267744779587, 0.04796643795132637, 0.0479056598508358, 0.04784479556679726, 0.04777150725364685, 0.047720856828689574, 0.04765452868700028, 0.04759237071871757, 0.04754743926763535, 0.04747976136445999, 0.04741599959373474, 0.04734943369865417, 0.047281825746297836, 0.04721516259431839, 0.04717246335625649, 0.04709711527228355, 0.04706733021020889, 0.047054895943403244, 0.04699849640846252, 0.04696785688877106, 0.046934122471809385, 0.046903612716197966, 0.046870794017314914, 0.04681981552362442, 0.046782333582639696, 0.046749264632463455, 0.04671010020017624, 0.0466529311144352, 0.046623149733543395, 0.04656234014987946, 0.04652532154560089, 0.04648621320724487, 0.0464481329703331, 0.046400537552833555, 0.04635620650649071, 0.046313944309949874, 0.04625613795280457, 0.04620723572254181, 0.04615876851797104, 0.046096445736885074, 0.04604290278196335, 0.04599213401556015, 0.045938437678813934, 0.045884803463220596, 0.0458290348982811, 0.04577343639731407, 0.045717704533338545, 0.04565758059978485, 0.045607907955646516, 0.04555665873885155, 0.045512643893957136, 0.04546125142097473, 0.04541939120173454, 0.045369993476867675, 0.045330196005105974, 0.04528401795625687, 0.04522931721687317, 0.04517854879021645, 0.04513453042626381, 0.04506789806365967, 0.04502192746639252, 0.04496837763547897, 0.04490907824993134, 0.04486140369772911, 0.044800321575403215, 0.04475319300413132, 0.04469240456819534, 0.0446512419629097, 0.04460358535528183, 0.04455075380921364, 0.04450978523492813, 0.04446914393544197, 0.044422045282125476, 0.044374635887146, 0.0443312646985054, 0.04427843221306801, 0.04423426236867905, 0.04417674387454987, 0.044124021503925324, 0.04406800634145737, 0.044011964242458346, 0.04395602467656136, 0.04390081726789474, 0.04384817495942116, 0.043789171785116196, 0.04375378834009171, 0.04370199914693832, 0.04366302736401558, 0.04362931688904762, 0.04358627309679985, 0.04353779848575592, 0.04350664222955704, 0.04345681357860565, 0.0434131476354599, 0.04337348519086838]
p100_betas.append(estimate_loss(x, y, 32))

y = [1.8022540078735352, 1.2806301006698608, 1.0697138704299927, 0.9346517649841308, 0.8395430549049377, 0.7576290146446228, 0.6945078064727783, 0.6411583354759216, 0.5902921531867981, 0.5617545510292054, 0.5175063837051391, 0.49249271194458005, 0.48190564180374146, 0.4523104614639282, 0.42768003234863283, 0.4171580627632141, 0.41786474836349485, 0.4121964011764526, 0.4090179354476929, 0.3887370824432373, 0.3923573100090027, 0.38696861325263976, 0.3890353375816345, 0.38666689383506775, 0.37947110916137694, 0.3730276766395569, 0.3717264721298218, 0.3728088938713074, 0.3646231652832031, 0.3723535927200317, 0.3587950563526154, 0.3633564012336731, 0.36317463006973266, 0.35593160126686096, 0.3516719490623474, 0.3576413610363007, 0.3474991784667969, 0.35084790143966677, 0.35235102783203126, 0.34194422828674315, 0.3564540155792236, 0.3421698372554779, 0.33471734260559083, 0.3435705525493622, 0.34067473114967345, 0.337597348613739, 0.344187267036438, 0.33785667976379397, 0.3334907523155212, 0.3312120641899109, 0.3330585280227661, 0.33364631513595583, 0.3304926017475128, 0.3312664216995239, 0.32795433955192566, 0.32621833248138427, 0.32493466574668883, 0.3218232132434845, 0.31559975965499876, 0.3301049280643463, 0.31636332753181456, 0.32186632764816286, 0.3214613100147247, 0.32340764835357666, 0.3120776631164551, 0.3147973362159729, 0.31760708651542663, 0.31160117528915404, 0.3071717881679535, 0.3134953517246246, 0.3140215554046631, 0.3062319337844849, 0.31607549741744995, 0.305284184627533, 0.30744382612228394, 0.308447871799469, 0.30660321545600894, 0.3004821963310242, 0.2994819026374817, 0.30600184576034545, 0.30156209275245666, 0.2571873324632645, 0.23858254725456238, 0.23416324955940246, 0.22953687647342683, 0.2250442747116089, 0.22015943165302276, 0.21479074769973755, 0.20843861694335938, 0.201514466547966, 0.19401280863285064, 0.18530452546596526, 0.17591226228713988, 0.16793870552539825, 0.1624733777475357, 0.15628888452529907, 0.15083990694522859, 0.14534275373935698, 0.14222813713073731, 0.13996674431800843, 0.1346767067718506, 0.13140867782592774, 0.12777539953231812, 0.12495321954250335, 0.12396167519569397, 0.11973156184434891, 0.1171172918343544, 0.11456973190307618, 0.11400287238359451, 0.11165513355493545, 0.10910189513206482, 0.10633097935438156, 0.10382320671081544, 0.10185443582057953, 0.10431467054843903, 0.10056939057826995, 0.09905811242341996, 0.09714638630390167, 0.09597740506649018, 0.09429152458667756, 0.09219934359550476, 0.09107034556627273, 0.09081582313060761, 0.09061056834936142, 0.09020546021461487, 0.0898797893357277, 0.089478277759552, 0.08901615948200226, 0.08844059730529785, 0.08783173867940902, 0.08711148680448533, 0.08629049186468124, 0.08536921626091003, 0.08435460623025894, 0.08323678114652634, 0.08200545025348663, 0.08077738651275634, 0.07962483919382095, 0.07855993216514587, 0.07745395643711091, 0.07627622332811355, 0.07509682721614838, 0.0739864231300354, 0.07282115288257598, 0.07155750137805938, 0.07020010544776917, 0.06898270621299743, 0.06792399223804474, 0.06695046334981919, 0.06593119966983794, 0.06479907628774643, 0.06363585463047028, 0.06257532460808754, 0.06155524584531784, 0.06048634359240532, 0.05932972203731537, 0.05814361230611801, 0.057023170014619824, 0.05614305239796639, 0.055355870851278306, 0.05469492600679397, 0.05438254275679588, 0.05431020237922669, 0.054255303966999055, 0.054212670053243636, 0.05413469336152077, 0.05407121485233307, 0.054000111683607105, 0.053926903878450394, 0.053839332953691484, 0.05374537489295006, 0.053648605964183804, 0.05361105741739273, 0.05350654459238052, 0.0534669170832634, 0.05339893076896667, 0.05334594540834427, 0.053267957940101626, 0.05319758912920952, 0.0531241796195507, 0.05304206974506378, 0.052980388821363446, 0.05293556853413582, 0.05288667895555496, 0.05283578413844109, 0.05277373357772827, 0.05271030385017395, 0.05264899553179741, 0.05257375199556351, 0.05251199412584305, 0.05243875640392304, 0.05238365401029587, 0.05232070085883141, 0.05226809881329537, 0.05220865298986435, 0.05214944959282875, 0.052098574427366255, 0.052042721544504164, 0.05198332116127014, 0.0519369506752491, 0.051895777628421784, 0.05182994053840637, 0.05180093849658966, 0.05174843297123909, 0.05170222233057022, 0.05165715665578842, 0.051612796742916106, 0.051557630512714385, 0.051500231281518934, 0.05144777630805969, 0.05139019537448883, 0.05133557340741157, 0.051270983625650406, 0.051200563652515414, 0.05113714809179306, 0.05108730814218521, 0.05102128447890281, 0.05098603939771652, 0.050927203758955, 0.050891127784252164, 0.050844779424667357, 0.05080110617995262, 0.05075929528355599, 0.05070482244968414, 0.050662952806949615, 0.05060510794878006, 0.05055483105659485, 0.050496326856613157, 0.05045727870464325, 0.05040894009590149, 0.05035583811044693, 0.05030519830584526, 0.050248794857263565, 0.050187737556695936, 0.05011848762154579, 0.05005211255311966, 0.04998246566057205, 0.049921291335821155, 0.049851028856039044, 0.049826944146156314, 0.04975604545593262, 0.0497236571085453, 0.04971476310491562, 0.049675039731264116, 0.04964450761437416, 0.04961642791152, 0.049583296370506284, 0.049552229676246645, 0.049508499627113345, 0.04946392137646675, 0.04944830986142158, 0.04940053215265274, 0.04935916036844253, 0.04931096237540245, 0.04927002446532249, 0.04921394410133362, 0.0491477848815918, 0.04908890893340111, 0.049034951108694075, 0.04898117851018906, 0.04893951389193535, 0.04890006476163864, 0.04885691890716553, 0.048800324412584306, 0.04875339064598083, 0.04870218843460083, 0.04864725201368332, 0.04859758991837502, 0.04854963204503059, 0.04848776903390884, 0.04843640016913414, 0.04837766489982605, 0.04832000410556793, 0.04825428169369698, 0.04820504840135574, 0.048135430629253385, 0.048081640696525575, 0.04801692313313484, 0.047954851715564725, 0.047884104285240175, 0.04781658996343613, 0.04774748500823975, 0.04766977500915527, 0.047604447660446164, 0.04753549202561379, 0.0474653953397274, 0.04740748268723488, 0.0473525056886673, 0.047288599119186404, 0.047247104172706604, 0.04720021681547165, 0.04716286861181259, 0.04713611314296722, 0.04708963316202164, 0.04705036000967026, 0.04701093843817711, 0.04696125937342644, 0.04690769002556801, 0.046858861759901047, 0.046796148294210436, 0.04673920297026634, 0.04667520352602005, 0.046616078011989595, 0.04655677587985992, 0.04650752847671509, 0.046451063768863675, 0.04639111082315445, 0.04633568324804306, 0.046269213993549343, 0.04621292890191078, 0.04614332363128662, 0.0460838039970398, 0.04601599281311035, 0.04595796646475792, 0.04590468957781792, 0.0458487904727459, 0.04579968709349632, 0.04574090923309326, 0.0456878227186203, 0.045631309102773666, 0.04557833014369011, 0.04552321878194809, 0.04548119917750359, 0.045441674568653105, 0.04538919220328331, 0.04534531164765358, 0.04529958403587341, 0.04524445562839508, 0.045187214809656144, 0.045133297438621524, 0.04507424518108368, 0.045014244227409364, 0.04495659595966339, 0.0448913386964798, 0.04483283777713776, 0.04477012570142746, 0.0447075339615345, 0.0446415406703949, 0.04456855525493622, 0.0445015371465683, 0.04443641813755035, 0.04437815801858902, 0.04432339486241341, 0.0442579426586628, 0.044196602737903594, 0.04413395478487015, 0.04407162166595459, 0.04401093501329422, 0.04395002992391586, 0.04389542711615563]
p100_betas.append(estimate_loss(x, y, 44))

y = [1.9346793173980712, 1.4130011152648925, 1.174568328819275, 1.0223811544799806, 0.9114998733520507, 0.8276016174888611, 0.7588351790809631, 0.7008858864593506, 0.6494322318649292, 0.6121191487693787, 0.5700243884658813, 0.5461719376373291, 0.5205611001014709, 0.5003165738296509, 0.4830798108863831, 0.4748299507904053, 0.4563285454559326, 0.45269960058212283, 0.4469345652198792, 0.44258256810188296, 0.4350529967880249, 0.43145249383926393, 0.42178793912887574, 0.41994795557022097, 0.41494874517440794, 0.4196614973068237, 0.4054881286048889, 0.40437797582626345, 0.4021321945953369, 0.39711241622924803, 0.40773037019729613, 0.39635307415008547, 0.39634427786827087, 0.39467201588630674, 0.3843051436328888, 0.3913864224243164, 0.39084229556083677, 0.37896645424842834, 0.38018212319374084, 0.3830690913486481, 0.3734768866443634, 0.37708777587890624, 0.3779959730911255, 0.37286286469459534, 0.36660532043457034, 0.37271648657798767, 0.36570762855529787, 0.36906788269042967, 0.36305267045021056, 0.36194727162361146, 0.365650614528656, 0.3582518544769287, 0.36063752656936643, 0.3607920976638794, 0.3601488105201721, 0.35085694012641905, 0.352703686800003, 0.35141311054229735, 0.34993210065841673, 0.3518874482345581, 0.3414301624107361, 0.3537012058830261, 0.34662605239868166, 0.34778379030227663, 0.33880931415557863, 0.3325123418045044, 0.3408955326652527, 0.34221713763237, 0.3314600331878662, 0.3460800177001953, 0.33446724889755247, 0.33345176536560056, 0.3305455619621277, 0.32546549068450925, 0.3389764458847046, 0.3275718899345398, 0.3240277280139923, 0.3271615340900421, 0.33197308561325073, 0.32379579825401306, 0.3169135687828064, 0.2775837210941315, 0.256308132648468, 0.25056684670448304, 0.24568585799217224, 0.2402936135673523, 0.23461721279144288, 0.22815032948493957, 0.22060568212985993, 0.2122954791736603, 0.20285799403190613, 0.19254168739795685, 0.1811890795993805, 0.168914530005455, 0.15863474192619323, 0.1549520423269272, 0.1492880467414856, 0.14598735061645507, 0.14233593573570252, 0.13823204050540924, 0.13407643450737, 0.12975269730091096, 0.12473604751586914, 0.12583330427646636, 0.1212372254872322, 0.11770385993719101, 0.11514126657962799, 0.11348243317365646, 0.1107325937128067, 0.10979615026950836, 0.11104618136167527, 0.10634226392507554, 0.10366477022171021, 0.10164303653240205, 0.09924583212137222, 0.09683828350305557, 0.10349216078281402, 0.09671300331115723, 0.09409443414926529, 0.09262253243684769, 0.09089086382389068, 0.08987717814683914, 0.08947079800128936, 0.08920134577989579, 0.08888787284135818, 0.08851816865444183, 0.08810845393180847, 0.08761227100372314, 0.08703717098712921, 0.08638725612163543, 0.08563075155258179, 0.08476560567617417, 0.08380606256723404, 0.08268744237661362, 0.08146484624147415, 0.08013166422843933, 0.07878116868257523, 0.07736650156259536, 0.07594872854948044, 0.07449092905759812, 0.0729858054637909, 0.07147940070867538, 0.06990586540222168, 0.06825660855293274, 0.0665983257818222, 0.06500423796415329, 0.06348411577224732, 0.06219420367717743, 0.06098185063481331, 0.060106842867136, 0.05957959325790405, 0.05907573528409004, 0.05854112419605255, 0.05792690107584, 0.05727625998616218, 0.05671043960571289, 0.056156102645397186, 0.05552240247726441, 0.05483819905042649, 0.05416825344800949, 0.05351187738776207, 0.0531290947329998, 0.053054821605682374, 0.05295709708571434, 0.05288417581319809, 0.05278340849041939, 0.052677509973049166, 0.052578357570171354, 0.05246496598005295, 0.05238530204057693, 0.052269632563591004, 0.05218758080482483, 0.052096951848268507, 0.05199714652180672, 0.051879589375257495, 0.051762959909439084, 0.051630442692041395, 0.0514843971657753, 0.05134400928854942, 0.05118261710762977, 0.051035286166667936, 0.0509236650121212, 0.05086537295818329, 0.050805438762903214, 0.05075363375306129, 0.0506959120118618, 0.05064017693519592, 0.05058315919280052, 0.05053089052557945, 0.05046333545565605, 0.050406023391485213, 0.0503447247004509, 0.05027688278079033, 0.050227490928173066, 0.050161416020393375, 0.050107306156158445, 0.05004300891637802, 0.04998228316545487, 0.049924865046739576, 0.049857402569055555, 0.0498051690518856, 0.04974833721995354, 0.04970068168878555, 0.049639877610206606, 0.049578666578531265, 0.04952102573990822, 0.04945468204259872, 0.0493796756374836, 0.04931611963629723, 0.04924413717150688, 0.049176019483804706, 0.04910910273551941, 0.049039936693906785, 0.04896426723718643, 0.04888666024327278, 0.048802140463590625, 0.04871598901033401, 0.048642487267255785, 0.04858085865855217, 0.04851817171692848, 0.04845958506345749, 0.048398244210481646, 0.04833943303823471, 0.04828677535414696, 0.048235930119752884, 0.04817313617706299, 0.04812818374752998, 0.04807396211624145, 0.04801214710116387, 0.04794708394408226, 0.04789754330873489, 0.0478270352268219, 0.047763489384651185, 0.04770128141403198, 0.04763157033324242, 0.047554887465238574, 0.04748045330047607, 0.04741284122467041, 0.047342557286024094, 0.047280584526062014, 0.047228171019554135, 0.047160989842414854, 0.04711169548034668, 0.047060113805532454, 0.04700973190188408, 0.046957387944459916, 0.04690578765392304, 0.0468513116312027, 0.046816280510425565, 0.04675506392359734, 0.046708618683815005, 0.04665185195565224, 0.046607044699192045, 0.046553713096380234, 0.04650594190120697, 0.04645941618442535, 0.04639646485686302, 0.04633713082551956, 0.04627306624650955, 0.0462046809732914, 0.04615248592376709, 0.04610400320887566, 0.0460505357503891, 0.04598978170871735, 0.045926326570510864, 0.04586461572885513, 0.045797921478748324, 0.04573610763192177, 0.04567177973508835, 0.045616492763757704, 0.04555016941905022, 0.045493989454507826, 0.04546378521800041, 0.04540245403051376, 0.04537346690773964, 0.04533480571627617, 0.04530810867071152, 0.04526849752426147, 0.04522459115147591, 0.04517541258215904, 0.045126252244710924, 0.04506745880961418, 0.045004492815732954, 0.04494333528280258, 0.04487262504458427, 0.044810083220005036, 0.04474823811292648, 0.04468885791063309, 0.044638564752340314, 0.044587260451316835, 0.04453956599473953, 0.044480360610485076, 0.0444314755487442, 0.04436884497523308, 0.044326110934019086, 0.04428936097383499, 0.04424349696516991, 0.044194831366539004, 0.04414694407105446, 0.04410303542137146, 0.044059295839071276, 0.04401529802799225, 0.04396753360271454, 0.04391778444409371, 0.0438673835837841, 0.04380870100259781, 0.043755172995328905, 0.04369642138838768, 0.04362888400793075, 0.043561349598169326, 0.04349410036087036, 0.043428552268743516, 0.043360490044355396, 0.043289974308013915, 0.04322704966425896, 0.04315833582639694, 0.04309434171795845, 0.04303445960402489, 0.04297465045213699, 0.04292183404445648, 0.042857285845279695, 0.042806490354537964, 0.04274293216586113, 0.04268596243619919, 0.04262000950813293, 0.042559317079782485, 0.04253300584435463, 0.04247770123004913, 0.04244251984834671, 0.04240688969016075, 0.04236568880200386, 0.04232443845748901, 0.042277892870903014, 0.042243102632761, 0.042185533983707425, 0.042136302807331084, 0.0420802683365345, 0.04201727243304253, 0.041947187737226485, 0.04189200398087502, 0.041823539608716966, 0.04175207608222961, 0.04168532940983772, 0.04161885023355484, 0.0415509024643898, 0.041490048439502714, 0.041421829854249956, 0.04137003457069397, 0.041318363585472105, 0.04125812949895859]
p100_betas.append(estimate_loss(x, y, 56))

print("-----------------------------------")

# K80
y = [1.5748339975357055, 1.1515037052154542, 0.9572815728569031, 0.8330649461364746, 0.7442742045021057, 0.6685513697052002, 0.6108845170402527, 0.560068168258667, 0.5134407913589477, 0.47002949253082277, 0.4307802262115479, 0.40639467926979067, 0.381591667098999, 0.35519654007911683, 0.3390790588188171, 0.3338419541835785, 0.3258927428722382, 0.30619709627151487, 0.30619582921504973, 0.3046074281692505, 0.30082268540382384, 0.2988731046009064, 0.2886992248249054, 0.2938882476234436, 0.28628896192550657, 0.28733156195640563, 0.28248149500846864, 0.28818573541641235, 0.27802158513069153, 0.28870902673721316, 0.27529304030418394, 0.2837628237247467, 0.2730087739849091, 0.2810370523929596, 0.27400504674911497, 0.27690827664375306, 0.28444030904769896, 0.27314861190795897, 0.27515785653114316, 0.2791579266262054, 0.26531798139572144, 0.28105507382392886, 0.27670725286483766, 0.2706802808570862, 0.26916216625213624, 0.273225263376236, 0.27268241821289063, 0.26565497270584104, 0.26947256048202517, 0.27462175083637236, 0.2712540263938904, 0.26855927583694456, 0.2663302623653412, 0.27113029955863954, 0.2627260196399689, 0.26980943264961244, 0.2651452123451233, 0.26450513930797576, 0.2654015626716614, 0.2718798820972443, 0.2643373863172531, 0.2598401121520996, 0.26517225762367247, 0.2666192936706543, 0.2689365252113342, 0.26406896510124206, 0.2603091320705414, 0.25797062494277956, 0.26537703864097595, 0.2600601521873474, 0.2686934382724762, 0.25959345116615296, 0.2545171092891693, 0.26439256360054014, 0.25450520001411436, 0.26513105732917785, 0.2573534041595459, 0.2623674858379364, 0.25780556042671204, 0.25485792885780334, 0.25971194801330566, 0.21837664001464843, 0.2003812964105606, 0.1961495775461197, 0.19326495223045348, 0.1906449397611618, 0.18800180477619172, 0.18498117652893067, 0.18169164345741273, 0.1780069640493393, 0.17371197929382323, 0.16900754776477814, 0.1637306439065933, 0.15776978944778441, 0.15123378826618195, 0.14415556468963622, 0.13740925522327424, 0.13359003878116607, 0.1291337381887436, 0.12546263908147812, 0.12176573293924332, 0.1179214652132988, 0.11393893435239792, 0.11155466949701309, 0.11023318395137786, 0.10647599240303039, 0.10416443803548812, 0.10189535709381103, 0.0993374160003662, 0.09732158437490464, 0.09825871789932251, 0.09472230953454971, 0.09289048243284226, 0.09117607935190201, 0.08987098099470138, 0.08846631118059159, 0.08747756630182266, 0.08576786977529526, 0.08455634213447571, 0.08493009008646012, 0.08392124057769776, 0.08268592096328735, 0.08161250477313996, 0.08143681716680527, 0.0811864099764824, 0.08103573162078857, 0.08075831990242005, 0.08052229625463486, 0.08028100834608078, 0.08002695429086686, 0.07969700268983841, 0.07932542423725128, 0.07895547349452972, 0.07848712635040284, 0.07800454405069351, 0.07751958801269532, 0.07693220995426178, 0.07636023547649383, 0.0757543174624443, 0.07510378735542297, 0.0744351013636589, 0.07372392201662063, 0.07294605916976929, 0.07221362688302994, 0.07152438402175904, 0.07086763932704926, 0.07021310375928878, 0.06957285376310349, 0.06888950011014938, 0.068146883456707, 0.067384339594841, 0.06659418607473373, 0.0658127016377449, 0.06499629883050918, 0.06415983074188232, 0.06329223191261292, 0.062461965831518175, 0.061633759232759475, 0.060795355489254, 0.05993299867272377, 0.05909213562965393, 0.05867413296937943, 0.058628618067502976, 0.058541224983930586, 0.0584901144528389, 0.05843613124728203, 0.058367564516067505, 0.058290193883180616, 0.05822186995267868, 0.05814011461853981, 0.05807619485378265, 0.057989484530687335, 0.057914674880504606, 0.05784326687335968, 0.05775859426498413, 0.057672412271499635, 0.057599351814985274, 0.05750400963902474, 0.0574342613697052, 0.05734758078217506, 0.05727621039032936, 0.05720657099604606, 0.05715578140258789, 0.05712111460089683, 0.05706808788657188, 0.05702920752167702, 0.05697602906107903, 0.05692741195440292, 0.056883057029247286, 0.05683001242756844, 0.05678874950408935, 0.05673323404669762, 0.05671367698550224, 0.056663562422990796, 0.05661782965540886, 0.05658109765291214, 0.0565333113861084, 0.056491248511075974, 0.056457893615961076, 0.056405350682735445, 0.05635866534113884, 0.05631785187363625, 0.05627776804566383, 0.05622842099785805, 0.056188674314022066, 0.056146965173482895, 0.056094902986288074, 0.05607327488183975, 0.05602842764735222, 0.056001679949760436, 0.055981795393228534, 0.055944089243412015, 0.0559122690653801, 0.05587940919995308, 0.05584610489726067, 0.05581101481676102, 0.05576965450525284, 0.05572014551281929, 0.05567620580196381, 0.05562130703568459, 0.05559423261761665, 0.05553867387533188, 0.055500551019906995, 0.055448207412958146, 0.05542204558849335, 0.055367245607376096, 0.055314623038768766, 0.0552832033097744, 0.055239853134155276, 0.05519139533519745, 0.05514301004648209, 0.055092133996486665, 0.05502902772426605, 0.0549808932697773, 0.05491970111966133, 0.05487079146146774, 0.05481585247278214, 0.054752797207832334, 0.054707523144483565, 0.054652339214086534, 0.05458742437362671, 0.05453579799175262, 0.054487496560812, 0.05443653594613075, 0.05440249490380287, 0.054351201874017714, 0.05431670928001404, 0.054274824479818344, 0.0542312491106987, 0.05418018632769585, 0.054143815921545026, 0.05409425036907196, 0.05404001861810684, 0.053997556777000424, 0.05395221687793732, 0.053893949846029285, 0.053861014273166655, 0.053816921343803406, 0.0537683409678936, 0.05374887964844704, 0.05368516441464424, 0.0536477579498291, 0.053601343313455584, 0.05356084700584412, 0.05351624952673912, 0.053467000687122346, 0.05342548535704613, 0.05336935530781746, 0.05331655434966087, 0.05327156862974167, 0.05320905135512352, 0.05316153110265732, 0.0531012165749073, 0.0530513714325428, 0.052988045481443403, 0.05293025601029396, 0.052883035645484924, 0.052817088786363604, 0.052767559727430344, 0.052702337774038314, 0.05264780788898468, 0.052586183165311814, 0.05253639436125755, 0.052481295200586316, 0.05243424413561821, 0.052387308139801025, 0.05233628889322281, 0.052289023073911665, 0.0522479558300972, 0.0522158009159565, 0.052163854576349256, 0.052133485437631605, 0.05208741920232773, 0.05204576156139374, 0.05200157914280892, 0.05194695878267288, 0.0518983490896225, 0.05185872688412666, 0.051795880802869794, 0.05175649494886398, 0.051716381837129594, 0.051673302198648456, 0.05162721864581108, 0.05158557017803192, 0.05154519851922989, 0.0515077763068676, 0.051468146892786025, 0.05142170678257942, 0.05139180785655975, 0.05135552006006241, 0.051314856762886045, 0.05128311845064163, 0.051248053594827654, 0.05120265872120857, 0.05116756500005722, 0.05113202643632889, 0.05108553054094315, 0.051037659960985186, 0.05098940656423569, 0.050935911647081375, 0.05088920978307724, 0.0508436938393116, 0.05079438966989517, 0.05075492587208748, 0.05072271816730499, 0.05067221058726311, 0.050637467867136, 0.05062096855044365, 0.05057416422843933, 0.050547837800979614, 0.05050328322172165, 0.050469663566350936, 0.050434239717721936, 0.05038957548737526, 0.05035191052913666, 0.05031993908166885, 0.050272767287492755, 0.050249403465986255, 0.05020556900858879, 0.05016623774409294, 0.05014202549099922, 0.05010244205355644, 0.05006600976228714, 0.05003805936574936, 0.04999206273794174, 0.04995303795695305, 0.049909283871650695, 0.04986524381756782, 0.04982439667224884, 0.049779254945516584]
k80_betas.append(estimate_loss(x, y, 20))

y = [1.6379553644561768, 1.1981138555526734, 0.995160671863556, 0.8643728324317932, 0.7640867572212219, 0.6949714170074462, 0.6284827979087829, 0.5751039579391479, 0.5319172865486145, 0.4960406190109253, 0.46536971655845644, 0.4293131207275391, 0.40724635889053346, 0.39300325695991517, 0.374231817741394, 0.3681969753074646, 0.3508800440692902, 0.35169751456260684, 0.3407327023410797, 0.33741921442985534, 0.3287114680862427, 0.32561034348487855, 0.3190224649620056, 0.3274196869182587, 0.33023027242660524, 0.31307335428237915, 0.3122913796901703, 0.3139130322265625, 0.31147394511222837, 0.3162608496570587, 0.31518826072692874, 0.3064073243045807, 0.30791708724975586, 0.30594897172927854, 0.3125775418663025, 0.30350584752082826, 0.30581467503547666, 0.3053162563228607, 0.3012344593715668, 0.2992591446876526, 0.3003910239601135, 0.3122910858631134, 0.29368587527275086, 0.2933473294830322, 0.3016761808681488, 0.2999212666320801, 0.2971389300823212, 0.29655023681640624, 0.30000735314369203, 0.29500793078422544, 0.29748322967529295, 0.2931180970954895, 0.29079124272346496, 0.2968700247955322, 0.29278173931121826, 0.2855289551830292, 0.29244820917129516, 0.29491867115974424, 0.2855918959712982, 0.29238826118469236, 0.2942295465660095, 0.28103119705200197, 0.28819728024482727, 0.28346686002731325, 0.28760005393981936, 0.29206184420585635, 0.2829268576717377, 0.28073238753318785, 0.28815761448860167, 0.2815489760160446, 0.2831764831161499, 0.27822702130794524, 0.29027884605407717, 0.2780891329288483, 0.2787535726642609, 0.29205335964202883, 0.27238908414840696, 0.2760125378990173, 0.2837508965778351, 0.2821857969045639, 0.27749623304367066, 0.23522331627368928, 0.21775756383419037, 0.21303472627639772, 0.20984286868095398, 0.2067439274597168, 0.2035072581386566, 0.19987467803001405, 0.1957093734884262, 0.19107828648090364, 0.18578749207496642, 0.17988633560657502, 0.17318018810272218, 0.16576374261856078, 0.15780893837928772, 0.1499487289953232, 0.14594773001194, 0.14146390105724335, 0.13785617205142975, 0.13400569314956665, 0.1306133944416046, 0.12671989386558533, 0.12246742821216583, 0.11792003680944443, 0.11988822939157485, 0.11485287184238434, 0.11195016520261765, 0.10981485084056854, 0.10792090990781784, 0.1059861121726036, 0.10532808312177658, 0.10315144755125046, 0.10129665346860886, 0.09887390906333923, 0.0967296614098549, 0.09468152493476868, 0.09642840702056885, 0.09656411298274994, 0.0923080632185936, 0.09140309765338897, 0.0895629536652565, 0.08871587737560273, 0.08846846454143524, 0.0882737732887268, 0.08800897279024124, 0.0878170348763466, 0.08751984538078308, 0.08717948088884353, 0.08680198130607605, 0.08637366403818131, 0.08593430621623993, 0.08536619394063949, 0.08485023888349533, 0.08424329169511795, 0.08359947055578232, 0.08287146385192871, 0.0820867954325676, 0.08120585675239562, 0.08023062324047088, 0.07917153650045394, 0.07811815429210663, 0.07713031586647033, 0.07610996156215667, 0.07504577245473862, 0.07396301678419114, 0.07281586621522904, 0.07159635010242463, 0.07050465411186219, 0.06954131476640701, 0.06871484370708465, 0.06787034818172455, 0.06697875837802887, 0.06600566837310791, 0.06501342053890229, 0.06415189733266831, 0.06356198615789413, 0.06311505251407623, 0.06261920357704162, 0.06208539418339729, 0.06150931855678558, 0.060866697508096694, 0.060472921179533005, 0.060403169734478, 0.06031038017511368, 0.060214061543941495, 0.06010714331388473, 0.06000034047842026, 0.059893164850473406, 0.05978589626431465, 0.05967921360135078, 0.05958025018334389, 0.0594840239906311, 0.05937864066720009, 0.05925590479016304, 0.059154720941782, 0.05903154650211334, 0.05892045891880989, 0.058827508931159976, 0.058726228680610656, 0.058637304418087004, 0.058537556833028796, 0.05847025223493576, 0.058427556636333464, 0.0583812694144249, 0.05833462073922157, 0.058273850462436674, 0.058218834916353226, 0.0581699714255333, 0.05810485088706017, 0.058046315125226976, 0.05797542850613594, 0.05791885179281235, 0.05784980155110359, 0.05779452647447586, 0.0577350226187706, 0.0576707313477993, 0.05761876848101616, 0.057573734548091886, 0.05751586588382721, 0.05748446504712105, 0.057430138188600544, 0.05739811988353729, 0.05734386738657951, 0.05730304180502892, 0.05725739244699478, 0.057212920110225676, 0.057157154569625855, 0.05711087654352188, 0.05704807383537292, 0.05700098123311997, 0.056942483673095706, 0.056886360911130904, 0.05683023903489113, 0.05677895126700401, 0.05671721922636032, 0.05667254000067711, 0.05661797142982483, 0.05656518625259399, 0.05650571814417839, 0.05646217995762825, 0.05639996885538101, 0.056346313916444776, 0.05628624156236649, 0.05622206360220909, 0.05618007061719894, 0.05612401464104652, 0.0560686272418499, 0.05601049778938293, 0.055952257455587386, 0.055888514167070386, 0.05582667011022568, 0.05576498921513558, 0.055696837162971496, 0.055641005343198775, 0.0555774660384655, 0.055517169642448426, 0.0554459747505188, 0.05538537469625473, 0.05531027971148491, 0.05523947080373764, 0.05517163944363594, 0.05509588869333267, 0.0550315706050396, 0.05496662988424301, 0.054918245499134065, 0.05484562557220459, 0.05478429350614548, 0.05471674300074578, 0.05465318218588829, 0.0545982743537426, 0.054539158849716184, 0.054484003854990005, 0.05442709884285927, 0.05438081103801727, 0.05431946839213371, 0.05426819221258163, 0.054211278530359265, 0.05415517612814903, 0.05408727364063263, 0.05402651544213295, 0.053957561180591584, 0.053892819559574125, 0.05381501219749451, 0.05374608765482902, 0.05367217022061348, 0.05360713334083557, 0.0535441025853157, 0.05347104681015015, 0.05340186040520668, 0.05333767907977104, 0.05326396673798561, 0.053196355574131014, 0.05313270940303803, 0.05307303189635277, 0.05301722251772881, 0.052952779064178467, 0.05289669794559479, 0.05284150433063507, 0.05277193960666657, 0.05271519587635994, 0.052651532571315766, 0.05259678341388702, 0.052539240889549255, 0.05248940719127655, 0.052435853991508484, 0.05238591634511948, 0.05232353548884392, 0.05228478858709335, 0.05221891413331032, 0.052163843698501584, 0.05210975841641426, 0.052049948608875275, 0.05199238584280014, 0.051927244079113005, 0.051876044586896895, 0.051809554448127744, 0.05175472034811974, 0.051704859231710434, 0.05165760637283325, 0.05160580222010613, 0.05155700917124748, 0.051519717777967454, 0.05146794484257698, 0.051434884253740314, 0.0513934802365303, 0.0513415426170826, 0.051302938829660416, 0.05125028991818428, 0.05121083373904228, 0.05115560610413551, 0.05111912829518318, 0.051078296531438826, 0.051022805193662646, 0.0509807459282875, 0.05092839517593384, 0.050871824748516085, 0.050825632157325745, 0.05077411307811737, 0.050727788844108584, 0.050677380030155185, 0.05063375705480576, 0.05058165623545647, 0.05053145051836967, 0.05047550723195076, 0.05043039182901383, 0.050369357808828355, 0.05031952352166176, 0.05028114436030388, 0.05023371020078659, 0.05017829807400703, 0.05013544850826263, 0.05008395011305809, 0.05003574637889862, 0.04998330304145813, 0.04994284137487411, 0.0499061133480072, 0.04986152922749519, 0.04981527486085892, 0.04977897739052772, 0.0497441875731945, 0.049725582838058474, 0.04968527594089508, 0.04966126031398773, 0.04963323763370514, 0.049606676388978956, 0.0495749530684948, 0.049570029609203335, 0.04951338112950325, 0.04949088069677353, 0.04946195516943932]
k80_betas.append(estimate_loss(x, y, 26))

y = [1.7037770250701905, 1.2213348161315918, 1.019775608253479, 0.8962580630874634, 0.7976186115837097, 0.7227074339103698, 0.6641157870101929, 0.6144978751373291, 0.5647712620925903, 0.5190795001602173, 0.48786985054016113, 0.4618236603355408, 0.4291110104751587, 0.41584836539268494, 0.39967326292037963, 0.3828209118461609, 0.37752994073867796, 0.3725760531044006, 0.3632900151824951, 0.3570417806243896, 0.3516500022125244, 0.3452475936698914, 0.3457502786922455, 0.34685038900375365, 0.34002523272514346, 0.3415338218212128, 0.3426173114871979, 0.33695905534744264, 0.32926456377029417, 0.3381731858062744, 0.3312558985233307, 0.32123644361495973, 0.3311065125656128, 0.3301319680023193, 0.3258842938232422, 0.32432918332099914, 0.32437701097488403, 0.31981437514305117, 0.3223024600028992, 0.3215917758369446, 0.3193093822956085, 0.31680100253105165, 0.32396267029762266, 0.32064467642784117, 0.31028578620910646, 0.3204368390083313, 0.32069531295776366, 0.30648198205947874, 0.31091515513420104, 0.31428580147743224, 0.31276905139923095, 0.29767312405586244, 0.31682210313797, 0.3102158877468109, 0.3013751480007172, 0.3024723326301575, 0.31556194211006167, 0.3053628806495666, 0.29177181323051454, 0.3092131428718567, 0.30755978061676026, 0.2924008507633209, 0.29510725090026857, 0.30548434619903564, 0.30178752284049987, 0.2990344101238251, 0.291248999004364, 0.2980842479133606, 0.2995630412006378, 0.2969718877506256, 0.29106298163414, 0.3010283767032623, 0.2850652013015747, 0.2939115514373779, 0.2934187085533142, 0.2882135320663452, 0.28596065538406373, 0.2935329393386841, 0.2899527913761139, 0.2829851422691345, 0.28381813747406004, 0.24175291231632232, 0.22513363983154297, 0.2204602422094345, 0.2168443576002121, 0.21320706501960754, 0.20932167521953582, 0.2049972824525833, 0.20007561093330384, 0.1944301718044281, 0.18822272753715516, 0.18099472286224366, 0.17335878950595857, 0.16517772893428803, 0.15720359594345093, 0.150011104221344, 0.14416128666877748, 0.13925275527477265, 0.1355957671546936, 0.1315567708158493, 0.12741954317569731, 0.12350842006444931, 0.12014398270130157, 0.11978494454622268, 0.11555578774452209, 0.1125535740852356, 0.1103146216225624, 0.1077602636218071, 0.10559631628751755, 0.10759056935548782, 0.1032075959610939, 0.10109666434526443, 0.099238312561512, 0.09761486458778382, 0.09579496188163757, 0.09881647997617722, 0.09639887042045593, 0.09275419908761978, 0.09167289241313935, 0.08999460317611695, 0.0886463763332367, 0.08766394119501114, 0.08736293509244919, 0.08705694591045379, 0.08679638922929764, 0.08647043458461762, 0.08606931936025619, 0.08566168000221253, 0.08514839652299881, 0.08456498835086823, 0.0839166468667984, 0.08316750410795212, 0.08242574718236924, 0.08160338555335998, 0.08075945406198502, 0.07984970978021622, 0.07888409047603608, 0.07783729749917984, 0.07666656468629837, 0.07542557419538498, 0.07430773117542266, 0.0733203661608696, 0.07232034908294678, 0.0712570371890068, 0.07016954850196838, 0.0692063302397728, 0.0683637571144104, 0.06755490537881852, 0.06672618693828583, 0.06585612472772598, 0.06496345771312714, 0.06403650148391724, 0.06307401285171509, 0.062069704551696775, 0.061060745248794554, 0.060050836789608, 0.05902912718296051, 0.05804623086571693, 0.057144660301208496, 0.05622938229203224, 0.055386378437280656, 0.05491547326683998, 0.05481350442290306, 0.054725771822929384, 0.05461792319655418, 0.054513334156274795, 0.05441406572699547, 0.054301203466653826, 0.054183371044397355, 0.054066529039144516, 0.05400135828375816, 0.053898754230737686, 0.053830186191797254, 0.05375862765669823, 0.05367135445952415, 0.0535876792883873, 0.05350375543951988, 0.053397812843322755, 0.053413147279024124, 0.05325237478017807, 0.053194164962768554, 0.053159065020084384, 0.05311438509464264, 0.05309300097465515, 0.053059577161073686, 0.05301637737989426, 0.052976282274723056, 0.0529440131020546, 0.0528948093688488, 0.05283608602166176, 0.05279784020662308, 0.052740342642068866, 0.0526904305434227, 0.052634475473165514, 0.0525832189810276, 0.052526986998319626, 0.05246426973104477, 0.05241062295794487, 0.05236894578099251, 0.052315857952833174, 0.05227081747174263, 0.052230200332403186, 0.05218687858343125, 0.052139583574533466, 0.052091386127471925, 0.05204454733490944, 0.05199417805910111, 0.05194513377904892, 0.05189868130683899, 0.051843648533821104, 0.05179848652243614, 0.05175571863651276, 0.05170378196835518, 0.05166674465179443, 0.051609044691324234, 0.05161001021385193, 0.051572385696172715, 0.051535810005664824, 0.051513545931577684, 0.05147416872262955, 0.051441874893903734, 0.05140312603116035, 0.05137067905426025, 0.05132280871391296, 0.051269926820993426, 0.05123766810655594, 0.05118317717194557, 0.051131939141750335, 0.05108833784222603, 0.051033227509260176, 0.05097757281184197, 0.050932377635240556, 0.050875657867193225, 0.05083331199407577, 0.050776605595350265, 0.05072797928929329, 0.05066931425333023, 0.050619014146327974, 0.05057723742723465, 0.05051634882569313, 0.050456088621616366, 0.05040472856283188, 0.05034449390888214, 0.05027954573512077, 0.05022086800813675, 0.050149467667341234, 0.0500856997859478, 0.05001977068185806, 0.049954362930059434, 0.04988939815163612, 0.049818980094194415, 0.04974960838675499, 0.04968475185751915, 0.04962038604617119, 0.04955172196626663, 0.04949516993880272, 0.04943355569124222, 0.049360627546310425, 0.04931102093219757, 0.04925773106575012, 0.049204892457723616, 0.04915304317474365, 0.049100199111700056, 0.04906068821310997, 0.04900879234910011, 0.0489630682694912, 0.04891362004160881, 0.04886965147137642, 0.0488188730764389, 0.04877718994140625, 0.048718804146051405, 0.048680590282678605, 0.04861499580025673, 0.048576994041204455, 0.048521725237369535, 0.048474865411520004, 0.048425028648376466, 0.04837089220523834, 0.048316265213489536, 0.048252943946123124, 0.04819523238062859, 0.04813382022857666, 0.048079963706731794, 0.04802519349813461, 0.047973490648269654, 0.04791180181264877, 0.04785602747440338, 0.047800667011737824, 0.04774391113400459, 0.04767662839651108, 0.04762504345297813, 0.04756266221642494, 0.04750868108391762, 0.04744354049682617, 0.047402850488424304, 0.047345844314098356, 0.047297810362577436, 0.04724902364611626, 0.04721262773513794, 0.04715793299913407, 0.04711680040597915, 0.04706975260615349, 0.04702845828771591, 0.04698120317220688, 0.04693109218597412, 0.046878795726299285, 0.04682080119609833, 0.04676630897283554, 0.04670849476695061, 0.04664904578089714, 0.04658593451499939, 0.046530750542879105, 0.04647789872527122, 0.04643573304057121, 0.04639191222786904, 0.046347885440587995, 0.046299617075920105, 0.046250094476938244, 0.04619874680399895, 0.0461542141354084, 0.046107334587574, 0.04605717689990997, 0.04601947551488876, 0.045967088741064074, 0.045916922631263735, 0.04586589555025101, 0.045811854236125944, 0.04576244841098785, 0.04571460825204849, 0.0456599177801609, 0.04561239140748977, 0.045563887453079224, 0.045510108218193054, 0.045454309040308, 0.045408040506839754, 0.04534823859810829, 0.045305834740400314, 0.04524951987266541, 0.04519397584438324, 0.04513724842786789, 0.045096457208395, 0.04504734755396843, 0.0450042587184906, 0.044960106824636456, 0.04492804497718811, 0.04488532407879829, 0.04484094809532165, 0.04479655453324318, 0.04475549289107323, 0.04471412269115448]
k80_betas.append(estimate_loss(x, y, 32))

y = [1.7818221168518067, 1.3131919696044922, 1.1008298546981812, 0.9625417911529541, 0.8641893283462524, 0.781604773311615, 0.7242026559066772, 0.6667146049118042, 0.6223646838569641, 0.5740192308616638, 0.5371418947219848, 0.5126602206802369, 0.4882539838218689, 0.4707827214050293, 0.46363640055656435, 0.43668744984626773, 0.43561148103713987, 0.42469264444351196, 0.42326289976119996, 0.4131668456840515, 0.4067173572063446, 0.40465974559783935, 0.4031597364521027, 0.39857137338638304, 0.39742210690498353, 0.3932995531272888, 0.39143593033790586, 0.38861954763412476, 0.3944232762908936, 0.3731101574897766, 0.3791707548236847, 0.3779604705142975, 0.3827391904067993, 0.3755170135116577, 0.37567834191322325, 0.37489710732460024, 0.37018786301612855, 0.3666435694217682, 0.3651395116233826, 0.36788464325904846, 0.3693583101081848, 0.3529205535507202, 0.3590447073841095, 0.3624787631034851, 0.3549100845623016, 0.35626493004798887, 0.354093219537735, 0.3530875460624695, 0.3513720653629303, 0.35671963532447815, 0.34275165802955626, 0.35759375565528867, 0.34193835158348085, 0.33694045908927917, 0.34625637656211855, 0.3479768511104584, 0.34312497406959536, 0.33690401821136473, 0.34407778460502625, 0.332806614780426, 0.3335058272743225, 0.33995394083976743, 0.3301608383369446, 0.33373446989059447, 0.3327362237071991, 0.33573051356315614, 0.33098652037620546, 0.3307054782772064, 0.32538108553886413, 0.3323558063697815, 0.32215124527931216, 0.32527337465286255, 0.32133351905822755, 0.3256818952846527, 0.3203564156341553, 0.3214255299091339, 0.3274717823314667, 0.3145951806259155, 0.3197084620952606, 0.31418825171470643, 0.3179094188976288, 0.27185608649253845, 0.2519886692905426, 0.24649700789928436, 0.24166312628746034, 0.23727750995635985, 0.2321411949491501, 0.22646184607982636, 0.2201649973964691, 0.21286977422237396, 0.20463698243618011, 0.19551291494846343, 0.1853624100255966, 0.17508412316799163, 0.16724979226112366, 0.1632526611185074, 0.15706603163719177, 0.15229524682044984, 0.14741919087409974, 0.14245464710235595, 0.1382205334186554, 0.1358378128004074, 0.13183306146144866, 0.12835830387592315, 0.12610961409568786, 0.12332759484291077, 0.12167580657720566, 0.11965406683206559, 0.11722528628110886, 0.11406473932027816, 0.11270039774656296, 0.11019242195606231, 0.10825891713857651, 0.10740724028110504, 0.10646904175758362, 0.10391480189323425, 0.10184687543153763, 0.1010599933552742, 0.10053212521314621, 0.09882786514759064, 0.09730053455352783, 0.09568136474609375, 0.0951705517077446, 0.09489001023769379, 0.09459514767169952, 0.09431526426076889, 0.0940342080616951, 0.09360255960226059, 0.09322394915580749, 0.0927760865354538, 0.09221987676858902, 0.09163773999214173, 0.09092311881780625, 0.09015347813606263, 0.08927662451505661, 0.08831195891141891, 0.08730848559856415, 0.0861963659119606, 0.08497395653247833, 0.08364819562911988, 0.08220644621133805, 0.08068749689340592, 0.07950376340150833, 0.07854597770929336, 0.07757828312158585, 0.07649791456699372, 0.07533856574773788, 0.07409996253490447, 0.07275423206806182, 0.07137299508810044, 0.07004066608428955, 0.06870664627790452, 0.06747178112983704, 0.06643684648752213, 0.06543040302038193, 0.06443082448005676, 0.06341255565404892, 0.06234925904273987, 0.06147025783777237, 0.06070388269901276, 0.059902689756155016, 0.05943103679060936, 0.0593353770160675, 0.059225365085601805, 0.0591025708770752, 0.05898082400798798, 0.05884615828275681, 0.05871164393663406, 0.05858661224484444, 0.0584599433350563, 0.05832576365709305, 0.05818826760411262, 0.058062199481725696, 0.0579391708779335, 0.05781799191594124, 0.05768306949257851, 0.0575437538933754, 0.05740277866721153, 0.05726331713080406, 0.05712905419707298, 0.057012992017269136, 0.05692052030801773, 0.0568645631814003, 0.05679819224238396, 0.056727791990041736, 0.0566688284778595, 0.05660777022004127, 0.05655737995266914, 0.056496116342544554, 0.056437396515607835, 0.05637722898125649, 0.05631056023597717, 0.05624573962807655, 0.056169089155197145, 0.05609553799629211, 0.05601675572037697, 0.0559444448518753, 0.05586288083910942, 0.05579309355974198, 0.055728343472480776, 0.055656371536254884, 0.05558959070086479, 0.055521386115551, 0.05544364654064179, 0.0553777470767498, 0.05530502381801605, 0.055235579042434695, 0.05515424700975418, 0.05508246831655502, 0.0549992803299427, 0.05493437790751457, 0.05487257423520088, 0.05479847092747688, 0.05473826733827591, 0.054669339175224305, 0.054599229130744935, 0.0545389029276371, 0.05446447195053101, 0.05440459885120392, 0.05434654689669609, 0.05427627742409706, 0.0542234573829174, 0.05416365423321724, 0.054110462665557864, 0.0540591447365284, 0.05399713397145271, 0.053941546244621275, 0.053878505618572235, 0.05381347012400627, 0.05374112145185471, 0.053662847464084625, 0.05359185904383659, 0.05350506790757179, 0.053420120968818666, 0.053340756225585935, 0.05326174363851547, 0.05318090027451515, 0.053111682665348055, 0.05303419609665871, 0.05296076140642166, 0.052886821985244754, 0.05281944655179977, 0.05278261031508446, 0.052726887891292575, 0.052682114683389666, 0.052633508642911914, 0.05258559095263481, 0.052539031845331194, 0.052478531382083894, 0.052417335320711134, 0.052349744194746015, 0.05228799923181534, 0.05221902340769768, 0.05214744576931, 0.052088813123703004, 0.05201685603260994, 0.05195868431806564, 0.05190976214528084, 0.05183339397549629, 0.051770883716344834, 0.05169409002900124, 0.051632089992761615, 0.051557199897766116, 0.05148814989924431, 0.051423063257932666, 0.051351414122581485, 0.05127987697124481, 0.0512050002014637, 0.05112302799701691, 0.051046363812685014, 0.05095688869833946, 0.05086521092295647, 0.05076990305542946, 0.05066613139986992, 0.050570867918729785, 0.05047865313410759, 0.0503965615093708, 0.05031910563588143, 0.050241347665786744, 0.050157133923769, 0.05007196090221405, 0.050002951867580414, 0.049929555487632754, 0.04986393290400505, 0.04979227329492569, 0.04973055474042892, 0.04965674422860145, 0.04958123095035553, 0.04950576129794121, 0.04945192785859108, 0.049389084641933444, 0.049354234097003936, 0.04931755140542984, 0.049277232794761656, 0.049232559064626695, 0.049185238357782365, 0.04915418122529983, 0.049100022221803666, 0.049052034772634506, 0.04900012972950935, 0.0489470700109005, 0.04889091365218162, 0.048833487856388094, 0.04877648206353188, 0.048751091437339786, 0.0486885712647438, 0.048659304175376894, 0.048628697156906125, 0.04860903008699417, 0.048567845927476885, 0.04853280111670494, 0.048486482002735136, 0.048444943854808804, 0.04839755600452423, 0.048346892187595365, 0.04828428072571755, 0.04823020444869995, 0.04816851212978363, 0.04809953463196755, 0.0480532012283802, 0.047977492789030074, 0.047925581792593, 0.04787642713546753, 0.047806820882558825, 0.04775580065846443, 0.047684952733516695, 0.047635624723434446, 0.047584942955970766, 0.0475396826338768, 0.04749377010941505, 0.04744258175611496, 0.04739083534359932, 0.047362962598800656, 0.04730780332684517, 0.04726363972783089, 0.04721711151003838, 0.047186991548538205, 0.04713497368454933, 0.047096097099781034, 0.04705299107193947, 0.047026452703475954, 0.04696152448654175, 0.04692007860660553, 0.04689424404978752, 0.0468370829641819, 0.04679234617352486, 0.04675030386686325, 0.04670471077680588, 0.04666009604215622, 0.04660267269253731]
k80_betas.append(estimate_loss(x, y, 44))

y = [1.9859610726928711, 1.443415885848999, 1.210997565803528, 1.0495855309295654, 0.952759445514679, 0.8554576413917542, 0.7893979948616028, 0.7323748366737366, 0.6780130239105224, 0.6360627039337158, 0.5992182754135131, 0.569840501537323, 0.5439818783187866, 0.5305708684921264, 0.5054141985702515, 0.49034398569107057, 0.48389700660705565, 0.469425140247345, 0.46708428915023803, 0.46065295381546023, 0.4514516170024872, 0.4500438659477234, 0.4378795505332947, 0.4429761139678955, 0.43494344314575195, 0.431121894569397, 0.4320862129878998, 0.4192893454742432, 0.4179786383724213, 0.4273798092460632, 0.40317643151283267, 0.42205558531761167, 0.41185545236587523, 0.4070606510257721, 0.40380108519554136, 0.40469274976730346, 0.4016570477104187, 0.39700366580963137, 0.39372323013305666, 0.3967938490486145, 0.39667047144889833, 0.39105580715179444, 0.38819545228004454, 0.3899883647441864, 0.38447817434310916, 0.38409976638793947, 0.381017214050293, 0.37466799498558045, 0.3870023042488098, 0.3755305858707428, 0.3682682770729065, 0.3773109632205963, 0.37233380061149596, 0.37357032864570616, 0.3608164688205719, 0.3649761751651764, 0.36845972111701963, 0.3624311532497406, 0.3664192111587524, 0.35502900042533875, 0.3645238096904755, 0.35203227774620055, 0.36219916489601134, 0.35638771124839785, 0.34622023831367493, 0.3605828321456909, 0.3546488864707947, 0.3380204706287384, 0.3587685078239441, 0.35642894819259646, 0.34098887097358704, 0.342165756816864, 0.350219417924881, 0.34090282511711123, 0.3381865643024445, 0.35007283955574037, 0.3398567859077454, 0.3403949890041351, 0.34366795132637024, 0.3290486660671234, 0.3384582577419281, 0.29200993411064147, 0.27032673971176147, 0.26383100409507754, 0.25856575452804564, 0.25311677837371827, 0.24706827579498292, 0.24042551273345947, 0.23278092886924745, 0.2241065378332138, 0.21453436398029327, 0.20385947668552398, 0.19239381192684174, 0.1801739265871048, 0.16963505066871643, 0.16538500212192536, 0.15833201930999755, 0.15356218747615813, 0.1484234461402893, 0.14294175848960877, 0.1389820226716995, 0.1383275508260727, 0.13261810712337493, 0.1296881292438507, 0.12655375787734985, 0.12404935045719147, 0.12282032705783844, 0.12051615792751312, 0.11919150412082673, 0.11524330919981003, 0.11256356802225113, 0.11040363653182983, 0.11095628998756409, 0.10892758259296417, 0.10525412905693055, 0.10384177221775055, 0.10322512975931168, 0.10199271090269088, 0.10074451407194138, 0.09798153483867646, 0.09737759001255035, 0.09593753907680512, 0.09512119216442108, 0.09480535532474518, 0.09450091431617737, 0.09413945082426071, 0.09377499958515167, 0.0933509299826622, 0.09285720395565034, 0.09233099174976349, 0.09167091886043549, 0.09094596227645874, 0.09020333754301071, 0.08930556077718735, 0.08836028281211852, 0.08729104305505753, 0.08610045319080353, 0.08477413286685943, 0.08332519431114196, 0.08178753409862519, 0.08040457360267639, 0.07917647689342498, 0.07792765310525894, 0.07660786446094513, 0.07518692201375961, 0.073683999376297, 0.07207310124874115, 0.07044828930854798, 0.06889706609487534, 0.06749375752925872, 0.06626760902643204, 0.0650921951174736, 0.06384943538665772, 0.06253226952433587, 0.06116343552708626, 0.05990433522105217, 0.05871005521416664, 0.057580735268592836, 0.05645864507675171, 0.05543099802494049, 0.054457417260408404, 0.053921409548521045, 0.053799660303592685, 0.05368826255679131, 0.05356953269839287, 0.053489861866235736, 0.05338332717418671, 0.053286463052034376, 0.053203977489471435, 0.05309592533946037, 0.05299297249317169, 0.05288201450228691, 0.05276493893265724, 0.052639942264556885, 0.052499385420084, 0.05234952301740646, 0.05219167206645012, 0.0520461290538311, 0.051912323204278944, 0.05178802679538727, 0.05166116023898125, 0.05156737760066986, 0.05150052801609039, 0.051438952232599255, 0.05137283706068992, 0.05130986488461495, 0.051238810091018674, 0.05117090601682663, 0.05109720101594925, 0.05102205225944519, 0.05093995753288269, 0.05085651507377625, 0.050775520263910294, 0.05069343906998634, 0.05061211542248726, 0.05053373591423035, 0.05048076759815216, 0.05041431649684906, 0.050372874586582184, 0.0503188872718811, 0.050268639190196994, 0.05021009747982025, 0.05013884799003601, 0.05007534634232521, 0.0499989237844944, 0.04993170079469681, 0.04985410170316696, 0.04978452192664146, 0.049712581927776334, 0.04963571995377541, 0.04955337787270546, 0.04947711326241493, 0.049396996273994444, 0.049326585738658904, 0.04924765603303909, 0.0491799670290947, 0.0490974646961689, 0.04904861093997955, 0.04897033240556717, 0.0489207839012146, 0.04887834163427353, 0.04883041888833046, 0.04878424787759781, 0.04873775675654411, 0.0486882286298275, 0.0486359505045414, 0.04858159989356994, 0.04852936999797821, 0.04847631080269814, 0.04841248960852623, 0.04835879858851433, 0.04829458653926849, 0.048247094485759735, 0.0481872848379612, 0.04813808334946632, 0.04807817692041397, 0.04802962906479836, 0.04797192537546158, 0.04792327278256416, 0.04785506189823151, 0.04780169513940811, 0.04773487761974335, 0.04768049695849419, 0.047621602650880814, 0.047561061561107634, 0.04749370713353157, 0.04742477078318596, 0.047353746000528336, 0.04727575937151909, 0.047188994300365446, 0.0471236214196682, 0.04705568558812141, 0.047001294015645984, 0.04693866205453873, 0.04687417500376701, 0.04680593800544739, 0.04675435673236847, 0.04669055634856224, 0.046637982827425005, 0.04658216593027115, 0.04652181297421455, 0.04645381499171257, 0.04638595444202423, 0.04631272563576698, 0.04625574223279953, 0.04618350952744484, 0.04612570712924004, 0.046064273676872255, 0.04600281776189804, 0.04593607478141785, 0.04586630843520165, 0.04579419436812401, 0.04572671774268151, 0.04565777666091919, 0.045597913377285006, 0.045528861826658246, 0.04548318286299705, 0.04542763696551323, 0.045383718546628954, 0.045333004608154294, 0.04528122377276421, 0.045220633198022844, 0.045164401792287825, 0.04509709307193756, 0.04503926521062851, 0.04498483435988426, 0.04492603132843971, 0.044875765523910524, 0.044823710931539536, 0.044762223209142686, 0.04470786380767822, 0.044637947951555255, 0.04456691902756691, 0.04449936912417412, 0.04443093781232834, 0.04436387685537338, 0.04429337045788765, 0.04422999276041985, 0.04416471910357475, 0.04411381010055542, 0.04406666142106056, 0.04402774077296257, 0.04398486841440201, 0.04393627591252327, 0.04388514187693596, 0.04382512091755867, 0.04376285974264145, 0.04370178768396377, 0.043639762921333314, 0.04357510081768036, 0.04351035281538963, 0.04346504715204239, 0.04340243409156799, 0.04335300892829895, 0.043299038614034654, 0.043241860172748565, 0.04318228279352188, 0.04312321259856224, 0.04305679604172707, 0.042989095430374144, 0.04293591574072838, 0.04288296415925026, 0.042844801907539365, 0.04280504054427147, 0.04276090967059135, 0.042716553113460544, 0.042670882173776625, 0.042620410956144335, 0.042571716327667236, 0.0425122868847847, 0.04245969440579414, 0.042401169068813326, 0.04234114735722542, 0.042277973729372025, 0.042223266373872755, 0.042158219051361086, 0.04210452197194099, 0.04205479439496994, 0.04199883471369743, 0.04194053267717361, 0.04188249132990837, 0.04181428237080574, 0.04175027302145958, 0.041697388973236084, 0.04164239196538925, 0.04160082414984703, 0.041556411874294284, 0.041506342500448226, 0.04146155579090118, 0.0414034543466568]
k80_betas.append(estimate_loss(x, y, 56))

print("-----------------------------------")

x = np.array([[1, 0, 0, 20],[1, 0, 0, 26],[1, 0, 0, 32],[1, 0, 0, 44],[1, 0, 0, 56],
              [0, 1, 0, 20],[0, 1, 0, 26],[0, 1, 0, 32],[0, 1, 0, 44],[0, 1, 0, 56],
              [0, 0, 1, 20],[0, 0, 1, 26],[0, 0, 1, 32],[0, 0, 1, 44],[0, 0, 1, 56]])
beta0_y = [i[0] for i in v100_betas] + [i[0] for i in p100_betas] + [i[0] for i in k80_betas]
beta1_y = [i[1] for i in v100_betas] + [i[1] for i in p100_betas] + [i[1] for i in k80_betas]
beta2_y = [i[2] for i in v100_betas] + [i[2] for i in p100_betas] + [i[2] for i in k80_betas]

beta0_reg = LinearRegression().fit(x, beta0_y)
beta1_reg = LinearRegression().fit(x, beta1_y)
beta2_reg = LinearRegression().fit(x, beta2_y)

betas_v100 = [beta0_reg.predict(np.array([[1,0,0,50]]))[0], beta1_reg.predict(np.array([[1,0,0,50]]))[0], beta2_reg.predict(np.array([[1,0,0,50]]))[0]]
betas_p100 = [beta0_reg.predict(np.array([[0,1,0,50]]))[0], beta1_reg.predict(np.array([[0,1,0,50]]))[0], beta2_reg.predict(np.array([[0,1,0,50]]))[0]]
betas_k80 = [beta0_reg.predict(np.array([[0,0,1,50]]))[0], beta1_reg.predict(np.array([[0,0,1,50]]))[0], beta2_reg.predict(np.array([[0,0,1,50]]))[0]]

print("Estimated for Resnet-50 on V100: beta0 {:.3f}, beta1 {:.3f}, beta2 {:.9f}".format(betas_v100[0], betas_v100[1], betas_v100[2]))
print("Estimated for Resnet-50 on P100: beta0 {:.3f}, beta1 {:.3f}, beta2 {:.9f}".format(betas_p100[0], betas_p100[1], betas_p100[2]))
print("Estimated for Resnet-50 on K80: beta0 {:.3f}, beta1 {:.3f}, beta2 {:.9f}".format(betas_k80[0], betas_k80[1], betas_k80[2]))

x = [math.ceil(i*50000/60) for i in range(1, 351)]

v100_exp = [1.8142928514480592, 1.3363951909255982, 1.1151085204315185, 0.9753110092926025, 0.8718031286811828, 0.7952632654953002, 0.7296795765686035, 0.6751348124313354, 0.627822056427002, 0.5852759760665893, 0.550310689868927, 0.5226995297050476, 0.5025857082366944, 0.4893275197029114, 0.47015431767463683, 0.4604515828895569, 0.4481004391288757, 0.4465129909801483, 0.4359564438819885, 0.43052829805374143, 0.42843725883483885, 0.42277698369026184, 0.42245372814178467, 0.41275525880813596, 0.410990968875885, 0.40778059129714966, 0.4021717783164978, 0.4068010742950439, 0.40210093574523925, 0.38922131660461423, 0.39624629596710204, 0.3895411949539185, 0.3867116033267975, 0.38439566242218015, 0.39568673005104066, 0.37399148586273195, 0.37768284581184386, 0.3831285863208771, 0.38423803462028505, 0.3808846892261505, 0.36706266156196593, 0.38476449636459353, 0.35973513491630554, 0.3701915515232086, 0.374259334897995, 0.3679010927772522, 0.35587849501609803, 0.35656094524383547, 0.3666520893955231, 0.36012612572669983, 0.35103134176254275, 0.36503057084083557, 0.3571699293231964, 0.35286691246032714, 0.35096898359298706, 0.3528477472782135, 0.35531552900314334, 0.3520803550052643, 0.34617671814918516, 0.34530826321601865, 0.351853668756485, 0.3382832498168945, 0.3396279493522644, 0.3527454487419128, 0.3370025482940674, 0.34554536710739137, 0.332517237701416, 0.34258557168960574, 0.3389844754219055, 0.33491356446266174, 0.34341502073287966, 0.322491990776062, 0.3306965588569641, 0.3315806865119934, 0.3272291294002533, 0.3302121655654907, 0.32861830375671386, 0.3273620328807831, 0.32609109890937804, 0.3194230424308777, 0.33087300751686094, 0.27804455924034116, 0.25847639652252197, 0.25266569109916687, 0.248075026345253, 0.2428486206817627, 0.23725254699230194, 0.23099520948410035, 0.22382839243888855, 0.21572916446685791, 0.20656410975933076, 0.19639906035900115, 0.18507962309837342, 0.17295072543621062, 0.15992030462265014, 0.15054957634449004, 0.14664877953052521, 0.14046402354240417, 0.1365263206911087, 0.13245991350650788, 0.1279257024860382, 0.12297709214448929, 0.11779346076965332, 0.12243541851997375, 0.11498674702644349, 0.11262124715328217, 0.11001853347063065, 0.10739823595285415, 0.10488080286026001, 0.10600860837697983, 0.1037276967716217, 0.10051669641971588, 0.09936637206792831, 0.09816102150678635, 0.0973337111210823, 0.0957624789071083, 0.09465630563497543, 0.09295712813854218, 0.09032351643323898, 0.08878186951637268, 0.0905075864648819, 0.08924519172668458, 0.0870430357670784, 0.0866015213727951, 0.08645330580234528, 0.08609496133327484, 0.08582041259765626, 0.08555157487869262, 0.08518392227172851, 0.0848695253777504, 0.08447373247385025, 0.08402943357229233, 0.08356111167192459, 0.08302377633810043, 0.08237536499023437, 0.081668912525177, 0.08085532293081284, 0.0799161881017685, 0.07891014811992646, 0.07784295310497284, 0.07669099095582962, 0.07547606522083282, 0.0742313095855713, 0.07285355813980103, 0.07135018666982651, 0.06994750841140747, 0.06881317711830139, 0.06772003740310668, 0.06655150614738464, 0.06533999185085297, 0.06423316548585892, 0.0631443597817421, 0.06201969409823418, 0.06087378292798996, 0.05990085800409317, 0.05905698380947113, 0.058276558674573896, 0.057468160552978514, 0.05658008645892143, 0.05566963079094887, 0.054809559088945387, 0.05432693087697029, 0.05422779091000557, 0.054129074093103406, 0.05402314885735512, 0.053906988430023194, 0.05378358366370201, 0.053659747761487964, 0.05352298065423965, 0.05337981008052826, 0.05323941001534462, 0.05309595326304436, 0.0529508074593544, 0.05280440423250198, 0.05267071083903313, 0.05252799786567688, 0.052389091671705246, 0.052238731549978254, 0.05211024529457092, 0.05197749961853027, 0.05185876808285713, 0.05175628002524376, 0.05168621337890625, 0.05161383580088615, 0.051535100837945935, 0.051449438791275025, 0.051361804615259174, 0.051268667670488356, 0.051182084929943084, 0.05109286582112312, 0.05101690850377083, 0.05094565786242485, 0.05088592415094376, 0.05081562102556229, 0.0507654529762268, 0.05070260184407234, 0.05064690113544464, 0.050587617048025134, 0.0505170449090004, 0.05045853036642074, 0.050397312875986096, 0.05034035607933998, 0.05028305192828179, 0.050224267781972885, 0.05016415326237678, 0.050094958815574644, 0.05002087863087654, 0.04993885164260864, 0.04985499277114868, 0.04976992686748505, 0.04967798474788666, 0.04959020407319069, 0.04949253694653511, 0.04940087732076645, 0.049305790174007415, 0.04920773372292519, 0.04913360167264939, 0.0490473881995678, 0.04897128910899162, 0.048884483354091644, 0.048794779216051104, 0.048709307290315626, 0.04863500922203064, 0.04856654925942421, 0.048492611856460574, 0.048414458124637606, 0.04833494697928429, 0.04824616035461426, 0.04817330916285515, 0.04810703374505043, 0.04805246091127396, 0.04799600738048553, 0.04793079754114151, 0.047877185516357425, 0.047809928983449934, 0.04774568969130516, 0.047672963273525236, 0.04760274715781212, 0.04753051911592483, 0.047453645529747006, 0.04737403295278549, 0.047301857942342755, 0.04723432246208191, 0.04716770464420319, 0.0471005117893219, 0.0470310910654068, 0.04695676216602326, 0.04688322729706764, 0.04681324289798736, 0.04674274940371513, 0.04668526757597923, 0.04663868423819542, 0.04657983307480812, 0.046538182713985445, 0.04648040152907371, 0.046429250683784486, 0.04638160101771355, 0.046318450055122376, 0.046268839049339296, 0.04621849123954773, 0.046160842711925505, 0.04610483157634735, 0.04604194747209549, 0.04598949760913849, 0.0459482610142231, 0.045887861711978915, 0.045838493621349334, 0.04578645713329315, 0.04572047890305519, 0.04565893604040146, 0.045596592276096345, 0.04552327476978302, 0.04547055978655815, 0.04540631688714027, 0.04535284101843834, 0.04529375509262085, 0.04523324147939682, 0.04516552093982697, 0.04509124943614006, 0.04502061288714409, 0.044949509003162386, 0.044875786234140395, 0.044797868634462355, 0.04472008924484253, 0.04463676673769951, 0.04454957156062126, 0.04446324410200119, 0.044384674619436265, 0.04432013483047485, 0.0442423434984684, 0.04417140680193901, 0.04409633127093315, 0.04402916307091713, 0.04397256294250488, 0.043910452783107755, 0.043855203521251676, 0.04378693867683411, 0.04372520402431488, 0.043653758034706114, 0.043604739369153975, 0.04354718889951706, 0.04352063260793686, 0.043466852618455884, 0.04342483808279037, 0.043378734776973724, 0.04332576052308083, 0.04328300754904747, 0.04322669069170952, 0.04319145363926887, 0.04313808932781219, 0.04309634645819664, 0.04303968937277794, 0.04299536113619804, 0.04293286373496056, 0.04289499331831932, 0.04286344699501991, 0.04281313223600387, 0.04277313473582268, 0.042736729768514635, 0.04269969623804092, 0.04264770814538002, 0.04259998181343078, 0.042537572767734524, 0.04248504845261574, 0.042425265145301816, 0.04236640188336372, 0.042302755625247955, 0.04224790054321289, 0.042179782391786574, 0.04211956580281258, 0.04205528821706772, 0.04200490943908691, 0.04194222140789032, 0.04189660458087921, 0.04185089952945709, 0.04180331826210022, 0.04174956973433495, 0.04169309527158737, 0.04164001674890518, 0.041584328267574314, 0.04153703765392303, 0.041490187052488324, 0.0414333923971653, 0.041374384198188785, 0.041313269270658495, 0.04126280168771744, 0.04119691245913506, 0.04113041684031486, 0.04106827411293983, 0.04099619798541069]
p100_exp = [1.926136055908203, 1.3943249962234496, 1.1465573838806153, 0.9970147930717468, 0.890556000881195, 0.8049829155349731, 0.7373160431671143, 0.6768856143951416, 0.6236432503128052, 0.5927648957443238, 0.5593210924530029, 0.5273509672737121, 0.5089936697483063, 0.4783750245857239, 0.47125551500320434, 0.46346958765029905, 0.44339538822174074, 0.4373183363342285, 0.42924203066825867, 0.42386001070022583, 0.4194711385154724, 0.41771531606674195, 0.4114555604553223, 0.4052903670310974, 0.4009485054016113, 0.4002944508552551, 0.3939847131538391, 0.3959430085945129, 0.39593937355041503, 0.38533330790519715, 0.39292791177749636, 0.3809697898197174, 0.3867712651157379, 0.3842962847137451, 0.3720385017776489, 0.3786384115409851, 0.37611627948760984, 0.36837475025177, 0.36984651320457457, 0.37123063853263855, 0.3649729060173035, 0.3640410349082947, 0.35924602317810056, 0.3616688793182373, 0.3597904511070251, 0.3599989811229706, 0.3628021723175049, 0.34929666776657103, 0.3565088190841675, 0.35187176542282106, 0.3510748105335236, 0.35485911840438844, 0.3376528637123108, 0.34733990549087523, 0.34656326597213744, 0.34657647071838377, 0.3437648620033264, 0.3449873424243927, 0.34213638743400576, 0.33285809965133667, 0.33678957487106326, 0.33804909987449644, 0.3329306243991852, 0.3338818868255615, 0.32433350600242616, 0.34127882425308226, 0.3337773871231079, 0.32911851420402527, 0.3262116184997559, 0.33193910245895386, 0.32233769786834715, 0.32899676317214965, 0.33248866598129273, 0.3197627010059357, 0.33069213907241823, 0.31617451884269715, 0.3269177112674713, 0.323922647485733, 0.31919143960952756, 0.31613684721946717, 0.3139669130706787, 0.2731003499698639, 0.25114007497787477, 0.24529747759342194, 0.24070451828956604, 0.23579813611030578, 0.2304927616119385, 0.22447783555030823, 0.21769023221969605, 0.20995987886428832, 0.20121203379154207, 0.19158640839099883, 0.18108533136367796, 0.16965651183128358, 0.1580926224374771, 0.15059764087677002, 0.14658448287963868, 0.14119885606765747, 0.1371409190416336, 0.1329137275314331, 0.1285347050333023, 0.12484276647567749, 0.1255037608027458, 0.12160008874177933, 0.11787483134508132, 0.11549206028223037, 0.11346031779289245, 0.11086343242406844, 0.10906412317514419, 0.10889210452795028, 0.10556178829193115, 0.10337952264308929, 0.1008664647269249, 0.0994322096133232, 0.10201618728160858, 0.09739461299180985, 0.09559848407745361, 0.0935413157081604, 0.09160675541877747, 0.0895965870475769, 0.09578792711496353, 0.09154649547815323, 0.08895219390630722, 0.08848658488273621, 0.08817781443834305, 0.08777658792495728, 0.08760830763578414, 0.08733265357255936, 0.08699181888103485, 0.08667608035087586, 0.08634307209014892, 0.08593887495756149, 0.08548905987739563, 0.08496441680192947, 0.08441474172830582, 0.08373319019317627, 0.0830005546426773, 0.082175336124897, 0.08124522148132324, 0.08026387293577195, 0.07923217673540116, 0.07821385620832444, 0.07721965406179428, 0.07621203647136689, 0.07510002936840057, 0.07395294022798538, 0.07278329950571061, 0.07157721387147903, 0.07031802462816239, 0.06904642766475677, 0.06771795104265213, 0.0663151796746254, 0.06496707326173783, 0.06360978577136993, 0.062275256341695784, 0.06122110254049301, 0.06030383404135704, 0.05957881489515304, 0.05900525981783867, 0.05844863362789154, 0.057845090948343274, 0.05747210738301277, 0.057406867612600325, 0.05731205612897873, 0.057228980402946474, 0.05714848813176155, 0.05706270333647728, 0.05698240237474442, 0.05690882500767708, 0.05680953245997429, 0.056726340777873994, 0.05662987872242928, 0.05652804274439812, 0.05639742965102196, 0.05626381050467491, 0.056111963789463044, 0.05594438363790512, 0.055771746448278425, 0.05559824763655662, 0.05543155770659447, 0.0552870415186882, 0.05521297310590744, 0.05515853741407394, 0.05510383919239044, 0.05504082053899765, 0.054985393642187116, 0.054930914405584334, 0.05486514145851135, 0.05479875474095344, 0.05473096433877945, 0.054658450988531115, 0.054581724115610124, 0.05449908240795136, 0.05440714492678642, 0.05431526501536369, 0.054218710952997205, 0.05413316030263901, 0.05403140571832657, 0.053938052183389665, 0.05385329962015152, 0.05377714906692505, 0.0536968376660347, 0.053625050877332686, 0.05355890604615211, 0.0534946288383007, 0.0534175816655159, 0.05335914305686951, 0.05329108098387718, 0.0532210020494461, 0.05316132427215576, 0.05309605470776558, 0.05302285365223885, 0.05294859749078751, 0.05287411703824997, 0.05278983098506927, 0.05271455385804176, 0.05263383974552154, 0.0525453205883503, 0.05245599316596985, 0.05237141525387764, 0.05228865802526474, 0.05220016900062561, 0.05213106864690781, 0.05205537145495415, 0.052004794541597364, 0.051935870543718336, 0.051880679066181185, 0.05181232270717621, 0.051762090063095095, 0.051695901203155516, 0.051626952667236325, 0.05156212145209312, 0.0514918746984005, 0.05140841664433479, 0.05132605252146721, 0.05124155211925507, 0.05117670967578888, 0.05109981278181076, 0.05103546375155449, 0.050965268288850785, 0.05091195180773735, 0.05084258717536926, 0.0507807142996788, 0.05071259343147278, 0.050641655933856965, 0.050583230372667314, 0.05051814177274704, 0.0504612068092823, 0.05039890761613846, 0.05034211908578873, 0.05028618315577507, 0.05022150165915489, 0.05014890690088272, 0.0500830465233326, 0.05002746529817581, 0.04996801420688629, 0.049918353179693224, 0.0498631642138958, 0.04980227336525917, 0.04974580468177795, 0.049686240018606186, 0.04962849860429764, 0.04956424683570862, 0.04950125298500061, 0.04943888897418976, 0.049368270598649976, 0.04929548367619514, 0.049228796421289446, 0.04915366198539734, 0.049080928975343704, 0.0490056831920147, 0.04893171021461487, 0.04884779987335205, 0.0487871554684639, 0.04871638349533081, 0.048649221160411836, 0.04857249590873718, 0.04849570749163628, 0.048412388525009155, 0.04835786414027214, 0.048304497661590576, 0.048253508553504944, 0.04821367684364319, 0.04816290626049042, 0.048114492815732955, 0.04805943996429443, 0.04799810551166534, 0.04794156487464905, 0.04787637785792351, 0.04780745594739914, 0.047732339195013046, 0.047671295065879825, 0.047601148662567136, 0.04753225133538246, 0.04747320841550827, 0.0473985379588604, 0.04732395899772644, 0.047243128641843796, 0.04716427386641502, 0.047083427582979204, 0.04700139397978783, 0.04692258768081665, 0.046841556975841525, 0.046770403175354004, 0.046691030361652376, 0.046615186331272124, 0.04654047393321991, 0.046476565742492676, 0.046402803070545194, 0.04640688712835312, 0.04630373429656029, 0.04627434219956398, 0.046239422324895856, 0.04620143721699715, 0.04616538640141487, 0.046115774413347244, 0.04606326992034912, 0.04602049342870712, 0.04596026391267777, 0.04591555232644081, 0.04585228918194771, 0.04580975026369095, 0.045762761882543565, 0.04573795199155808, 0.045685172731876375, 0.04567211330294609, 0.045619182016849516, 0.045589235097169875, 0.045552566907405855, 0.04551122687339783, 0.04546777588963508, 0.045419119688272475, 0.04538064464211464, 0.045324641197919846, 0.0452867053425312, 0.045242544748783114, 0.04519311886548996, 0.04513917266607285, 0.04508203183054924, 0.04501709240555763, 0.04495873808145523, 0.04489498584389687, 0.0448284188246727, 0.04476265200018883, 0.044696414036750794, 0.0446221856212616, 0.044558500607013704, 0.04450142170906067, 0.04444831034898758, 0.04439770763397217]
k80_exp = [2.0221410193252565, 1.4086104539871216, 1.1729987097930907, 1.0132346055603028, 0.8971316862106323, 0.811573961353302, 0.7458368046379089, 0.6952643128395081, 0.6425958400726318, 0.5988956169891357, 0.5601740608978272, 0.5359028589630127, 0.5069000371170044, 0.48732740789413453, 0.46250299070358275, 0.45534665245056155, 0.4462368571472168, 0.43470797660827637, 0.4204962564086914, 0.41334138332366943, 0.4210203428077698, 0.4140286967754364, 0.3988677904510498, 0.40414842352867125, 0.39200049156188965, 0.3882466003036499, 0.38656865905761717, 0.38651973289489744, 0.38007184782028197, 0.3854793439769745, 0.3739007689666748, 0.3798167631435394, 0.3729356349182129, 0.38051831401824954, 0.3673456101608276, 0.36861767166137693, 0.3699060006427765, 0.3640484313774109, 0.3588327766036987, 0.35788069312095644, 0.3553549547576904, 0.3643210999011993, 0.3567430021381378, 0.355098807849884, 0.34719172843933105, 0.35334435837745665, 0.3465025594425201, 0.3482110077857971, 0.34419912070274356, 0.35206184217453, 0.3447880374145508, 0.339459778547287, 0.34099648100852964, 0.3402998462295532, 0.33609226055145264, 0.34159685076713564, 0.33665130504608154, 0.33066975788116454, 0.3372413963317871, 0.33342215633392336, 0.3339384663963318, 0.3278116722869873, 0.32557915506362917, 0.3222150690460205, 0.3388577115058899, 0.32304484312057496, 0.32438013841629026, 0.322765098361969, 0.3246985355472565, 0.3280188260650635, 0.30353307836532595, 0.3244707729434967, 0.32179389625549315, 0.3150569867229462, 0.3214009592247009, 0.3183851067447662, 0.3147901731109619, 0.31303205165863035, 0.31358168963432315, 0.31667866154670715, 0.30487801334381104, 0.2602879943704605, 0.24399214084148407, 0.23918273018360137, 0.23484737802505493, 0.23020458570480345, 0.2250893320465088, 0.21959160229206084, 0.21311320691585542, 0.20578528015613556, 0.1976679136657715, 0.1885961633491516, 0.1786466383075714, 0.1680964090538025, 0.16438100340366363, 0.15734413500785827, 0.1526774210357666, 0.14826971695899963, 0.1433280168771744, 0.1380915067100525, 0.13671119502544404, 0.13255919220924378, 0.12917863003730773, 0.12554307591438293, 0.12275343826055526, 0.11991872898817062, 0.1195368204164505, 0.11674803693056107, 0.11479867155313492, 0.1132792703127861, 0.11015350661277772, 0.10817136323451995, 0.10556331311464309, 0.10393107344388962, 0.10622695494174958, 0.10345444188833236, 0.10027452111959458, 0.09842015250444412, 0.09787509269952774, 0.09640935296297073, 0.09615614314317704, 0.09449674164295196, 0.09351835238933563, 0.09306239902973175, 0.09284579663038253, 0.09257150729179382, 0.09225678483486176, 0.0919065717434883, 0.09149936554431916, 0.0910725323677063, 0.09053327254533768, 0.0899507205271721, 0.0893094810295105, 0.08856796417951583, 0.08776670655965806, 0.0869019717168808, 0.0860068635892868, 0.08515090869188309, 0.08428716253995895, 0.08334934327602386, 0.08235024759054184, 0.08129314640760421, 0.08019638264417649, 0.07912266938686371, 0.07799671024799347, 0.07674068744182587, 0.07539005811691284, 0.07405502607107163, 0.07286462285280228, 0.0716573819231987, 0.07063784078121185, 0.06964891677856445, 0.06856722453117371, 0.06746474206209183, 0.06650777318239212, 0.06564780069112777, 0.0647360130739212, 0.06387486158370971, 0.06318735511779786, 0.06260186965465546, 0.06201227499127388, 0.06167119310975075, 0.06160224883794785, 0.06153245918869972, 0.061441425482034684, 0.06135690755128861, 0.061273274763822556, 0.06120884513616562, 0.061102563002109526, 0.06104945407390595, 0.0609873769235611, 0.06091728798031807, 0.060833652874231335, 0.06078988456130028, 0.060688959807157515, 0.060628269681930545, 0.0605680785036087, 0.060491809993982314, 0.06041635570168495, 0.06033088675498963, 0.060235563004016876, 0.060157495592832566, 0.06010153527498245, 0.06004729170322418, 0.059986915383338925, 0.059921092767715456, 0.059849053452014925, 0.05978870674014092, 0.059717398524284364, 0.05964351003527641, 0.059576975362300874, 0.05950116217136383, 0.05942513030648232, 0.059349273252487185, 0.059264408190250396, 0.05918043923258781, 0.05909639892339706, 0.05901585063099861, 0.05893341810226441, 0.058873298660516736, 0.058784576264619824, 0.058735317220687866, 0.05868272351264953, 0.05863000104546547, 0.058567512385845184, 0.058511411802768705, 0.05845537439227104, 0.05839164205312729, 0.058330930676460266, 0.05828459604740143, 0.058231651648283006, 0.058181506850719454, 0.058122872666120526, 0.0580671711575985, 0.05801754317998886, 0.05797497772097587, 0.057915611772537234, 0.05786992067575455, 0.057823508695364, 0.05776894636273384, 0.05771046245098114, 0.05764688322305679, 0.05757234938621521, 0.057538817197084424, 0.057454467432498935, 0.05741260454297066, 0.05737592715859413, 0.05732654404878616, 0.05727199147701263, 0.05722015843629837, 0.057155705448389056, 0.05709771052956581, 0.05704270207285881, 0.05697730025172234, 0.05692481130719185, 0.056844136456251144, 0.056803943746089935, 0.05672665169477463, 0.056674905565977096, 0.05660773247003555, 0.056538405624628064, 0.056474414664506915, 0.05643614100813866, 0.05637166130781174, 0.05632682768583298, 0.05626528991580009, 0.056209405605792996, 0.056145219609737396, 0.05606987640857697, 0.05599567988276482, 0.05590883067250252, 0.05582073682188988, 0.05572987805604935, 0.05564082823038101, 0.05555937016248703, 0.05550716104388237, 0.05543076253056526, 0.05537828630566597, 0.055320850435495374, 0.055253251138925555, 0.055177487456798555, 0.05509588642001152, 0.05502925772666931, 0.054942947034835814, 0.05487389291524887, 0.05481050058126449, 0.05474325752258301, 0.054677818945646287, 0.054623417112827304, 0.05456008181214333, 0.05453217395067215, 0.05449673442602158, 0.05444399002552033, 0.05439993016123772, 0.05438738236308098, 0.054332595386505124, 0.05429649671316147, 0.054262311174869536, 0.05420864423513413, 0.05416134996652603, 0.05411919363737106, 0.05406116239309311, 0.054009150100946424, 0.05396442242264748, 0.05390230851888657, 0.05384593721747399, 0.05378024796843529, 0.053721783475875855, 0.05366939717531204, 0.053610263974666596, 0.053551596195697784, 0.05349883031606674, 0.05343400711297989, 0.05338533285856247, 0.053325396806001665, 0.053293293503522875, 0.05323009822964668, 0.05320515625834465, 0.05314526466846466, 0.05310406486511231, 0.05306025106549263, 0.05300305548071861, 0.052948689054250715, 0.052887616288661954, 0.05282637963891029, 0.05275219230532646, 0.05268291624903679, 0.05261010457634926, 0.05253130377531052, 0.052454302436113355, 0.05236614310622215, 0.052300423760414126, 0.05224024911046028, 0.05217108564019203, 0.0521144566488266, 0.05204924684882164, 0.0519846535551548, 0.051912602406740185, 0.051870139796733855, 0.051803144949674605, 0.05175329497814179, 0.05171275731921196, 0.05165984649300575, 0.05160683895111084, 0.05155577956676483, 0.051492964860200885, 0.05143548993706703, 0.05138202358484268, 0.051326372274160384, 0.05126798412561417, 0.05121226354122162, 0.05115603585124016, 0.05111328219890594, 0.05105168686032295, 0.05100331876635551, 0.0509388139295578, 0.05087800842642784, 0.05080446137070656, 0.05072840296626091, 0.0506508464217186, 0.05057206446647644, 0.050501729460954665, 0.050433354824781416, 0.0503524853861332, 0.050276284322738646, 0.05020219353914261, 0.0501161486852169, 0.05003868944525719, 0.049966436194181445, 0.04989952605485916]
v100_p = [func(x[i], betas_v100[0], betas_v100[1], betas_v100[2]) for i in range(350)]
p100_p = [func(x[i], betas_p100[0], betas_p100[1], betas_p100[2]) for i in range(350)]
k80_p = [func(x[i], betas_k80[0], betas_k80[1], betas_k80[2]) for i in range(350)]

plt.plot(x, v100_exp, label="V100 experiment")
plt.plot(x, p100_exp, label="P100 experiment")
plt.plot(x, k80_exp, label="K80 experiment")
plt.plot(x, v100_p, "-", label="V100 prediction")
plt.plot(x, p100_p, "-", label="P100 prediction")
plt.plot(x, k80_p, "-", label="K80 prediction")
plt.ylabel("training loss")
plt.xlabel("training steps")
plt.ylim((0, 0.5))
plt.legend()
plt.title("ResNet-50 Experiments vs Predictions")
plt.savefig("4.2loss.png")
print("Experiment plot is successfully generated")
plt.clf()

plt.plot(x, np.array(v100_p)/np.array(v100_exp), label="V100 percentage error")
plt.plot(x, np.array(p100_p)/np.array(p100_exp), label="P100 percentage error")
plt.plot(x, np.array(k80_p)/np.array(k80_exp), label="K80 percentage error")
plt.ylabel("percentage error")
plt.xlabel("training steps")
plt.legend()
plt.title("ResNet-50 Prediction Percentage Error")
plt.savefig("4.2error.png")
print("Experiment plot is successfully generated")
plt.clf()

def resource_speed(workers, param_servers):
    t0, t1, t2, t3, t4 = 1.02, 2.78, 4.92, 0, 0.02
    return 1/(t0 * 128/workers + t1 + t2 * workers/param_servers + t3 * workers + t4 * param_servers)

workers = [1,2,4,8,16,31,64,128,256,512,1024]
f_2p = [1/resource_speed(i, 2) for i in workers]
f_4p = [1/resource_speed(i, 4) for i in workers]
plt.plot(f_2p, label="2 parameter servers")
plt.plot(f_4p, label="4 parameter servers")
plt.xticks([i for i in range(len(workers))], workers)
plt.ylabel("time to accuracy")
plt.xlabel("number of workers")
plt.legend()
plt.savefig("4.3.png")
print("Experiment plot is successfully generated")
plt.clf()